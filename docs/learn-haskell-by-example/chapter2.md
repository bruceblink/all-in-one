---
sidebar_position: 3
typora-root-url: ./..\..\static
---
# ç¬¬ 2 ç«  å¤è€çš„ç§˜å¯†åœ¨çŽ°ä»£æœºå™¨ä¸Šå»¶ç»­ï¼ˆAncient secret keeping on modern machinesï¼‰


æœ¬ç« å†…å®¹åŒ…æ‹¬ï¼š

- å¦‚ä½•å»ºç«‹ä¸€ä¸ªåŸºç¡€çš„ Haskell é¡¹ç›®å¹¶è¿è¡Œä»£ç 
- Haskell å¸¸è§æ•°æ®ç±»åž‹ä¸Žå‡½æ•°çš„å·¥ä½œåŽŸç†
- ä½¿ç”¨å­—ç¬¦ä¸²å’Œåˆ—è¡¨æ‰§è¡ŒåŸºæœ¬æ“ä½œ
- é€šè¿‡å®ˆå«ï¼ˆguardsï¼‰ä¸Žæ¨¡å¼åŒ¹é…ï¼ˆpattern matchingï¼‰å¤„ç†ä¸åŒæƒ…å†µ
- æ“ä½œä¸å¯å˜æ•°æ®å¹¶è¡¨ç¤ºæ•°æ®è½¬æ¢

åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† Haskell æ˜¯ä»€ä¹ˆï¼Œå¹¶è®¨è®ºäº†å®ƒåœ¨è¯­è¨€è®¾è®¡ä¸Šçš„ä¸€äº›ç‹¬ç‰¹ä¹‹å¤„ã€‚æˆ‘ä»¬è¿˜å­¦ä¹ äº†çº¯å‡½æ•°ï¼ˆpure functionsï¼‰çš„ç‰¹æ€§ï¼Œä»¥åŠåƒ Haskell è¿™æ ·çš„çº¯å‡½æ•°å¼è¯­è¨€æ˜¯å¦‚ä½•ç»„ç»‡ç¨‹åºç»“æž„çš„ã€‚
 è¿™äº›æ¦‚å¿µå›ºç„¶é‡è¦ï¼Œä½†å…‰è¯´ä¸ç»ƒæ˜¯æ²¡æœ‰æ„ä¹‰çš„â€”â€”ç†è®ºå¿…é¡»ç»“åˆå®žè·µæ‰èƒ½çœŸæ­£æŽŒæ¡ã€‚çŽ°åœ¨ï¼Œæ˜¯æ—¶å€™åŠ¨æ‰‹å®žçŽ°æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé¡¹ç›®äº†ï¼

å­¦ä¹ ä»»ä½•ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œæ€»å¾—ä»ŽæŸå¤„å¼€å§‹ã€‚è™½ç„¶æˆ‘å¯ä»¥ç”¨æ•°å­¦æŽ¨å¯¼æˆ–å­¦æœ¯ç»ƒä¹ æ¥â€œæŠ˜ç£¨â€ä½ ï¼Œä½†è¿™æœ¬ä¹¦çš„ä¸»é¢˜æ›´è½»æ¾ä¸€ç‚¹ã€‚æœ‰äººç”šè‡³ä¼šè¯´è¿™äº›å†…å®¹æŒºæœ‰è¶£â€”â€”ä¸è¿‡ä½ ä¸ä¸€å®šå¾—è¿™ä¹ˆè®¤ä¸ºã€‚æœ¬ç« ä¸»è¦ä»‹ç» Haskell çš„è¯­æ³•ä»¥åŠç¼–å†™ç¨‹åºçš„åŸºæœ¬æ–¹å¼ã€‚ç”±äºŽ Haskell çš„æ ¸å¿ƒç†å¿µä¸Žå…¶ä»–ä¸»æµè¯­è¨€å¤§ç›¸å¾„åº­ï¼Œä½ æœ€å¥½æš‚æ—¶â€œå¿˜æŽ‰â€è‡ªå·±ç†Ÿæ‚‰çš„ä¸€äº›ç¼–ç¨‹æ¨¡å¼ã€‚å¯å˜å˜é‡ï¼Ÿé™æ€æ•°æ®ï¼Ÿå‘½ä»¤å¼æŽ§åˆ¶æµï¼Ÿâ€”â€”è¿™äº›æ¦‚å¿µåœ¨æˆ‘ä»¬å³å°†è¸å…¥çš„ä¸–ç•Œä¸­éƒ½æ˜¯ä¸å­˜åœ¨çš„â€œé»‘é­”æ³•â€ã€‚

æˆ‘çŸ¥é“åˆšæ‰çš„æ¯”å–»æœ‰ç‚¹å¤¸å¼ ï¼Œæ‰€ä»¥è®©æˆ‘è§£é‡Šä¸€ä¸‹ï¼šHaskell çš„çº¯å‡½æ•°å¼è®¾è®¡ä¸€å¼€å§‹å¯èƒ½ä¼šè®©äººæœ›è€Œç”Ÿç•ã€‚å¦‚æžœä½ ä¹‹å‰æ²¡æœ‰æŽ¥è§¦è¿‡å‡½æ•°å¼è¯­è¨€ï¼Œé‚£ä¹ˆæœ¬ç« çš„æ¦‚å¿µå¯èƒ½ä¼šæ˜¾å¾—æœ‰äº›å¥‡æ€ªã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºè¿™ç§è¯­è¨€çš„è®¾è®¡æ€è·¯ä¸Žæˆ‘ä»¬ç†Ÿæ‚‰çš„å‘½ä»¤å¼è¯­è¨€æˆªç„¶ä¸åŒã€‚ä¸¾ä¸ªä¾‹å­ï¼Œ**Haskell æ²¡æœ‰å¾ªçŽ¯ï¼** å½“ç„¶ï¼ŒHaskell æœ‰å¾ˆå¤šæ–¹å¼å¯ä»¥å®žçŽ°ä¸Žå¾ªçŽ¯ç±»ä¼¼çš„åŠŸèƒ½ã€‚ä¸¥æ ¼æ¥è¯´ï¼Œæˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦å¾ªçŽ¯â€”â€”ä½†è¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬å¿…é¡»é‡æ–°æ€è€ƒè®¸å¤šå…³äºŽâ€œç¼–ç¨‹â€çš„æ—§ä¹ æƒ¯ã€‚

è™½ç„¶è¿™å¬èµ·æ¥æœ‰äº›å¯æ€•ï¼Œä½†è¿™è¶Ÿæ—…ç¨‹éžå¸¸å€¼å¾—ã€‚Haskell çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯æ™®é€‚çš„â€”â€”å‡ ä¹Žå¯ä»¥åœ¨ä»»ä½•å…¶ä»–è¯­è¨€ä¸­å®žçŽ°ã€‚å­¦ä¹ çº¯å‡½æ•°å¼ç¼–ç¨‹çš„è¿‡ç¨‹ï¼Œå…¶å®žæ˜¯åœ¨å­¦ä¹ ä¸€ç§å…¨æ–°çš„æ€ç»´æ–¹å¼ï¼šå¦‚ä½•ç”¨æ•°å­¦åŒ–çš„æ€è€ƒæ–¹å¼å†™å‡ºæ­£ç¡®ä¸”å¯é çš„ç¨‹åºã€‚

æœ¬ç« å°†ä»Žå»ºç«‹ä¸€ä¸ªæ–°çš„ Haskell é¡¹ç›®å¼€å§‹ï¼Œå¹¶ä½¿ç”¨ Haskell ç¼–è¯‘å™¨çš„äº¤äº’æ¨¡å¼ï¼ˆREPLï¼‰æ¥ç¼–å†™ä¸Žæµ‹è¯•åŽŸåž‹ä»£ç ã€‚æŽ¥ç€ï¼Œæˆ‘ä»¬ä¼šä»‹ç» Haskell çš„å¤šç§åŸºæœ¬æ•°æ®ç±»åž‹ï¼Œä»¥åŠå¦‚ä½•ä¸ºå‡½æ•°å’Œè¡¨è¾¾å¼å®šä¹‰ç±»åž‹ã€‚ç„¶åŽæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ç¼–å†™å‡½æ•°ã€æ“ä½œå­—ç¬¦ä¸²ä¸Žåˆ—è¡¨ï¼›è¿›ä¸€æ­¥ï¼Œé€šè¿‡å®ˆå«å’Œæ¨¡å¼åŒ¹é…æ·±å…¥ç†è§£å‡½æ•°çš„ç»“æž„ä¸ŽæŽ§åˆ¶é€»è¾‘ã€‚æœ€åŽï¼Œæœ¬ç« ä¼šä»‹ç»å¹¶ä½¿ç”¨å†…ç½®çš„ **`map`** å‡½æ•°ã€‚


## 2.1 Haskell å…¥é—¨ï¼ˆA primer on Haskellï¼‰

çŽ°ä»£è®¡ç®—æœºç³»ç»Ÿå‡ ä¹Žéƒ½ä¾èµ–å¤–éƒ¨ç½‘ç»œæ‰èƒ½é«˜æ•ˆå·¥ä½œã€‚æ— è®ºæ˜¯é€šè¿‡ NTP æˆ– PTP è¿›è¡Œæ—¶é—´åŒæ­¥ã€åœ¨åˆ†å¸ƒå¼ NoSQL æ•°æ®åº“ä¸­å­˜å‚¨æ•°æ®ï¼Œè¿˜æ˜¯æ™šä¸Šçœ‹ä¸€æ®µ 4K çŒ«å’ªè§†é¢‘â€”â€”ç½‘ç»œæ— å¤„ä¸åœ¨ã€‚ä½†è¿™ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªé‡å¤§é—®é¢˜ï¼š**æˆ‘ä»¬å¿…é¡»ä¿æŠ¤åœ¨å…¬å…±ç½‘ç»œä¸­ä¼ è¾“çš„ä¸ªäººæ•°æ®ã€‚**æˆ‘ä»¬ä¸èƒ½æŠŠè‡ªå·±çš„é“¶è¡Œè´¦æˆ·ä¿¡æ¯å¯¹ç€æ£®æž—å¤§å–Šä¸€éï¼Œç„¶åŽç¥ˆç¥·æ²¡äººå¬è§ã€‚

æ­£å¦‚ä½ å¯èƒ½å·²ç»çŒœåˆ°çš„ï¼Œè§£å†³æ–¹æ¡ˆå°±æ˜¯â€”â€”**åŠ å¯†ï¼ˆencryptionï¼‰** ã€‚åŠ å¯†çš„åŸºæœ¬æ€è·¯æ˜¯ä½¿ç”¨ä¸€ä¸ªåŒæ–¹å…±äº«çš„â€œå¯†é’¥â€æ¥å¯¹ä¿¡æ¯è¿›è¡Œç¼–ç ã€‚å¦‚ä»Šï¼Œå¯†ç å­¦ï¼ˆcryptographyï¼‰å·²æ·±æ·±èžå…¥æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ï¼Œè€Œå®ƒçš„ç ”ç©¶é¢†åŸŸä¹Ÿåœ¨ä¸æ–­å‘å±•ï¼Œæå‡ºè¶Šæ¥è¶Šå¤æ‚çš„ç®—æ³•ä¸Žåè®®æ¥å®žçŽ°â€œå®‰å…¨ä¿å¯†â€çš„ç›®æ ‡ã€‚

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å®žçŽ°ä¸€ç§æœ€å¤è€ã€æœ€ç®€å•çš„åŠ å¯†æ–¹æ³•â€”â€”**å‡¯æ’’å¯†ç ï¼ˆCaesarâ€™s cipherï¼‰**ã€‚å®ƒåœ¨çŽ°å®žä¸–ç•Œä¸­æ—©å·²ä¸å†å®‰å…¨ï¼Œä½†å®ƒèƒ½å¾ˆå¥½åœ°å¸®åŠ©æˆ‘ä»¬ç†è§£å‡½æ•°å¼ç¼–ç¨‹çš„åŸºæœ¬åŽŸç†ã€‚

------

### 2.1.1 å‡¯æ’’å¯†ç ï¼ˆCaesarâ€™s cipherï¼‰

è¿™ä¸ªå¤è€çš„ç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿå‡¯æ’’å¯†ç é€šè¿‡å°†å­—æ¯è¡¨ä¸­çš„æ¯ä¸ªå­—æ¯æŒ‰å›ºå®šåç§»é‡æ›¿æ¢æˆå¦ä¸€ä¸ªå­—æ¯æ¥å®žçŽ°åŠ å¯†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥æ ¹æ®å­—æ¯åœ¨å­—æ¯è¡¨ä¸­çš„ä½ç½®é€‰æ‹©ä¸€ä¸ªæ–°çš„å­—æ¯ï¼Œä»Žè€ŒåŠ å¯†åŽŸå§‹å­—æ¯ã€‚

ä½ å¯ä»¥æŠŠå­—æ¯è¡¨æƒ³è±¡æˆä¸€ä¸ªè½®ç›˜ï¼Œæ‰€æœ‰å­—æ¯æŒ‰é¡ºåºæŽ’åˆ—æˆä¸€ä¸ªåœ†åœˆã€‚ä»ŽæŸä¸ªå­—æ¯å¼€å§‹ï¼Œå°†è½®ç›˜æ—‹è½¬ä¸€å®šåç§»é‡ï¼Œå°±ä¼šå¾—åˆ°æ–°çš„å­—æ¯ã€‚è¿™ä¸ªæ¦‚å¿µåœ¨å›¾ 2.1 ä¸­æœ‰ç¤ºæ„ã€‚

> **å›¾ 2.1 å­—æ¯æ›¿æ¢è½®ç›˜**
>
> ![figure2-1](/img/learn-haskell-by-example/chapter2/figure2-1.png)

é€šè¿‡å¯¹ä¿¡æ¯ä¸­çš„æ¯ä¸ªå­—æ¯è¿›è¡Œå˜æ¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹æ•´æ¡ä¿¡æ¯åŠ å¯†ï¼ç”¨äºŽè¿™ç§å˜æ¢çš„åç§»é‡å°±æ˜¯ç®—æ³•çš„**åŠ å¯†å¯†é’¥**ï¼Œéœ€è¦é€šä¿¡åŒæ–¹éƒ½çŸ¥é“ã€‚åœ¨è§£å¯†æ—¶ï¼Œåªéœ€åå‘æ‰§è¡ŒåŒæ ·çš„æ“ä½œï¼Œå°±å¯ä»¥æ¢å¤åŽŸå§‹ä¿¡æ¯ã€‚å›¾ 2.2 å±•ç¤ºäº†ä¸€ä¸ªä¾‹å­ï¼šä¸€ä¸ªå°ä¿¡æ¯è¢«åŠ å¯†æ—¶ä½¿ç”¨äº†åç§»é‡ 5ã€‚

>**å›¾ 2.2 å‡¯æ’’å¯†ç åŠ å¯†ç¤ºä¾‹**
>
>![figure2-2](/img/learn-haskell-by-example/chapter2/figure2-2.png)

å¦‚æžœåªåŠ å¯†åŸºæœ¬æ‹‰ä¸å­—æ¯ï¼ˆå¹¶ä¸”å¤§å†™å­—æ¯å’Œå°å†™å­—æ¯å„è‡ªä½¿ç”¨è‡ªå·±çš„å­—æ¯è¡¨ï¼‰ï¼Œä¼šå‡ºçŽ°ä¸€ç§æœ‰è¶£çš„å¯¹ç§°æ€§ï¼šå½“åç§»é‡ä¸º 13 æ—¶ï¼ŒåŠ å¯†å’Œè§£å¯†äº’ç›¸æŠµæ¶ˆï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ç”¨å®Œå…¨ç›¸åŒçš„æ–¹æ³•è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚è¿™ç§ç‰¹æ®Šçš„å‡¯æ’’å¯†ç ç§°ä¸º **ROT13**ï¼Œé€šå¸¸ç”¨ä½œæ–‡å­—æ··æ·†å·¥å…·ï¼Œå› ä¸ºå®žçŽ°éžå¸¸ç®€å•ã€‚ä¸€äº›ç¼–è¾‘å™¨ï¼Œå¦‚ Vim å’Œ Emacsï¼Œç”šè‡³å†…ç½®äº† ROT13 åŠŸèƒ½ï¼

ç¤ºä¾‹ï¼š`Vfaâ€™g gung arng?`

âš ï¸ **è­¦å‘Š**
 ä¸ºäº†ä¿æŠ¤ä½ å’Œä»–äººçš„æ•°æ®å®‰å…¨ï¼Œåˆ‡å‹¿åœ¨ä»»ä½•åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨è¿™ç§åŠ å¯†æ–¹æ³•ï¼

### 2.1.2 æ–°å»ºé¡¹ç›®ï¼ˆA new projectï¼‰

æˆ‘ä»¬å…ˆç”¨ **stack** åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ã€‚å¦‚æžœä½ è¿˜æ²¡æœ‰å®‰è£… stackï¼Œè¯·å‚è€ƒé™„å½• Aã€‚å·¥å…·é“¾å®‰è£…å¥½åŽï¼Œå¯ä»¥åœ¨æ“ä½œç³»ç»Ÿä¸­æ‰“å¼€å‘½ä»¤è¡Œã€‚åœ¨ macOS ä¸Šå¯ä»¥ä½¿ç”¨ iTermï¼ŒWindows ä¸Šå¯èƒ½æ˜¯ cmdï¼Œè€Œ Linux ä¸Šé€‰æ‹©æ›´å¤šæ ·ã€‚

ç„¶åŽï¼Œè¿›å…¥ä½ å¸Œæœ›å­˜æ”¾é¡¹ç›®çš„å·¥ä½œç›®å½•ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
stack new caesar
```

è¿™ä¼šåˆ›å»ºä¸€ä¸ªåä¸º `caesar` çš„æ–°ç›®å½•ï¼Œå…¶ä¸­å·²ç»åŒ…å«äº† Haskell é¡¹ç›®çš„é¢„è®¾ç»“æž„ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ stack åˆ›å»ºçš„ç›®å½•ç»“æž„ï¼ˆè§æ¸…å• 2.1ï¼‰ï¼š

- å®ƒåŒ…å«ä¸€äº›å…ƒä¿¡æ¯æ–‡ä»¶ï¼Œå¦‚ `CHANGELOG.md`ã€`LICENSE` å’Œ `README.md`ï¼Œç”¨äºŽè®°å½•å˜æ›´ã€æŽˆæƒä¿¡æ¯å’Œé¡¹ç›®ä½¿ç”¨è¯´æ˜Žï¼ˆå¦‚æžœé¡¹ç›®å‘å¸ƒçš„è¯ï¼‰ã€‚
- `caesar.cabal`ã€`package.yaml` å’Œ `stack.yaml` å¯¹é…ç½®ä¾èµ–å’Œç¼–è¯‘é€‰é¡¹å¾ˆé‡è¦ï¼Œä½†åœ¨æœ¬é¡¹ç›®ä¸­æˆ‘ä»¬æš‚æ—¶ä¸ä¿®æ”¹å®ƒä»¬ã€‚

é¡¹ç›®çš„æ ¸å¿ƒç›®å½•æ˜¯ `app` å’Œ `src`ï¼š

- `app` ç›®å½•åŒ…å«ç¨‹åºçš„å…¥å£æ¨¡å—ï¼ˆ`main`ï¼‰ï¼Œå³ç¼–è¯‘åŽçš„å¯æ‰§è¡Œæ–‡ä»¶çš„èµ·ç‚¹ï¼Œå°±åƒ C æˆ– Java ä¸­çš„ `main` å‡½æ•°ã€‚
- `src` ç›®å½•åŒ…å«åº“ä»£ç ï¼ŒåŒ…æ‹¬æ‰€æœ‰æ¨¡å—ã€ç±»åž‹å’Œå‡½æ•°å®šä¹‰ï¼Œå¯ä»¥ä½œä¸ºç‹¬ç«‹åº“ä½¿ç”¨ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¤šä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­å¤ç”¨ç›¸åŒåŠŸèƒ½ï¼Œæˆ–è€…å°†é¡¹ç›®ç¼–è¯‘ä¸ºåº“è€Œéžå¯æ‰§è¡Œæ–‡ä»¶ã€‚
- `test` ç›®å½•å¯ä»¥ç”¨æ¥å­˜æ”¾æµ‹è¯•å¥—ä»¶ï¼Œç”¨äºŽæµ‹è¯•åº“å’Œå¯æ‰§è¡Œæ–‡ä»¶çš„ä»£ç ï¼ˆå°†åœ¨ç¬¬ 9 ç« è¯¦ç»†è®²è§£ï¼‰ã€‚

**æ¸…å• 2.1 æ–°å»º stack é¡¹ç›®çš„ç›®å½•ç»“æž„**

```bash
caesar
â”œâ”€â”€ CHANGELOG.md
â”œâ”€â”€ LICENSE
â”œâ”€â”€ README.md
â”œâ”€â”€ Setup.hs
â”œâ”€â”€ app              #1
â”‚     â””â”€â”€ Main.hs
â”œâ”€â”€ caesar.cabal
â”œâ”€â”€ package.yaml
â”œâ”€â”€ src     #2
â”‚     â””â”€â”€ Lib.hs
â”œâ”€â”€ stack.yaml
â””â”€â”€ test        #3
       â””â”€â”€ Spec.hs
#1 ç”¨äºŽæž„å»ºå¯æ‰§è¡Œæ–‡ä»¶çš„æ¨¡å—
#2 ç”¨äºŽæž„å»ºç‹¬ç«‹åº“çš„æ¨¡å—
#3 ç”¨äºŽæµ‹è¯•åº“ä»£ç çš„æµ‹è¯•å¥—ä»¶
```

ç›®å‰æˆ‘ä»¬å”¯ä¸€éœ€è¦å…³æ³¨çš„æ–‡ä»¶æ˜¯ `Lib.hs`ï¼Œå°†åœ¨å…¶ä¸­ç¼–å†™å‡½æ•°ï¼Œå¹¶åœ¨ Haskell ç¼–è¯‘å™¨çš„äº¤äº’æ¨¡å¼ä¸­ä½¿ç”¨ã€‚

------

æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°è¯• **REPLï¼ˆReadâ€“Evalâ€“Print Loopï¼‰** æ¥ç†Ÿæ‚‰ Haskell çš„è¯­æ³•ã€‚è¿è¡Œï¼š

```bash
stack repl
```

è¿™ä¼šå¯åŠ¨ **GHCi**ï¼ˆGlasgow Haskell Compiler çš„äº¤äº’æ¨¡å¼ï¼‰ï¼Œæç¤ºç¬¦å¦‚ä¸‹ï¼š

```bash
ghci>
```

å¦‚æžœå½“å‰å·¥ä½œç›®å½•æ˜¯é€šè¿‡ stack åˆ›å»ºçš„é¡¹ç›®ï¼Œæ¨¡å—å’Œå®šä¹‰ä¼šè‡ªåŠ¨åŠ è½½åˆ° GHCi ä¸­ï¼Œå¯ä»¥ç›´æŽ¥æµ‹è¯•ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°è¯•ä¸€äº›åŸºæœ¬ç®—æœ¯ï¼š

```haskell
ghci> a = 1 :: Int
ghci> b = 2 :: Int
ghci> c = a + b
ghci> c
3
```

ä»Žä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­å®šä¹‰å˜é‡ï¼Œå°†å€¼ä¸Žåå­—å…³è”ã€‚REPL ä¼šå¯¹æ¯æ¡è¾“å…¥è¿›è¡Œæ±‚å€¼ï¼šèµ‹å€¼è¯­å¥æœ¬èº«æ²¡æœ‰ç»“æžœï¼Œè€Œå¯¹å˜é‡æ±‚å€¼åˆ™ä¼šæ˜¾ç¤ºå®ƒçš„å€¼ã€‚Haskell ä½¿ç”¨ `::` æŒ‡æ˜Žå€¼çš„ç±»åž‹ã€‚

> **æ³¨æ„**
>  åœ¨ GHCi ä¸­è¾“å…¥åƒ `1 + 1` è¿™æ ·çš„è¡¨è¾¾å¼ï¼Œä¼šå¾—åˆ°ç»“æžœ 2ï¼Œä½†å¯èƒ½è¿˜ä¼šçœ‹åˆ°å…³äºŽç±»åž‹é»˜è®¤çš„è­¦å‘Šã€‚å¦‚æžœä¸å¸Œæœ›çœ‹åˆ°è¿™äº›è­¦å‘Šï¼Œå¯ä»¥ä½¿ç”¨ `:set -Wno-type-defaults`ã€‚

------

æŽ¥ä¸‹æ¥æˆ‘ä»¬ç”¨å‡½æ•°æ¥å®žè·µå‡½æ•°å¼ç¼–ç¨‹ã€‚Haskell å‡½æ•°çš„è¯­ä¹‰ä¸Žå…¶ä»–è¯­è¨€ç±»ä¼¼ï¼ŒåŸºæœ¬è¯­æ³•å¾ˆç®€å•ï¼š

```haskell
å‡½æ•°å å‚æ•°åˆ—è¡¨ = å‡½æ•°å®šä¹‰
```

ä¾‹å¦‚ï¼š

```haskell
square x = x * x
```

å®šä¹‰äº†ä¸€ä¸ªå•å‚æ•°å‡½æ•° `square`ï¼Œå°†å‚æ•°è‡ªèº«ç›¸ä¹˜ã€‚å‡½æ•°è°ƒç”¨å¦‚ä¸‹ï¼š

```haskell
square 2
```

Haskell ä¸åƒå…¶ä»–è¯­è¨€é‚£æ ·ä½¿ç”¨æ‹¬å·æˆ–é€—å·åˆ†éš”å‚æ•°ã€‚åœ¨ REPL ä¸­è¾“å…¥ `square 2` ä¼šæ±‚å€¼å¹¶æ‰“å°ç»“æžœã€‚

å¤šè¡Œè¾“å…¥ç¤ºä¾‹å¦‚ä¸‹ï¼š

```haskell
ghci> :{               #1
ghci| square :: Int -> Int
ghci| square x = x * x
ghci| :}       #2
ghci> square 2
4
```

- `:{` å¼€å§‹å¤šè¡Œè¾“å…¥
- `:}` ç»“æŸå¤šè¡Œè¾“å…¥

ä¸º `square` æŒ‡å®šç±»åž‹ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†ä¸å†™ä¼šå‡ºçŽ°è­¦å‘Šã€‚

REPL é€‚åˆå¿«é€ŸåŽŸåž‹å’Œç®€å•æµ‹è¯•ï¼Œä½†å†™å¤§å‡½æ•°æ—¶å¯èƒ½ä¸å¤ªæ–¹ä¾¿ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šæŠŠå¤§éƒ¨åˆ†å®žçŽ°æ”¾åœ¨ `Lib.hs` ä¸­ã€‚

### 2.1.3 ç¬¬ä¸€ä¸ªæ¨¡å—ï¼ˆThe first moduleï¼‰

`Lib.hs` æ–‡ä»¶ä¼šæœ‰ä¸€ä¸ªéžå¸¸åŸºç¡€çš„ç»“æž„ï¼Œç”¨äºŽå±•ç¤º Haskell æ¨¡å—çš„åŸºæœ¬ç»„æˆã€‚æ¨¡å—åŒ…å«æˆ‘ä»¬çš„ä»£ç ï¼ŒåŒ…æ‹¬å®šä¹‰å’Œå®žçŽ°ï¼Œå®ƒä»¬å¸®åŠ©æˆ‘ä»¬ç»„ç»‡é¡¹ç›®ï¼Œå°†ç›¸å…³ä»£ç åˆ†ç»„ã€‚

é€šå¸¸æ¨¡å—åå¿…é¡»ä¸Žæ–‡ä»¶è·¯å¾„ä¸€è‡´ï¼ˆ`Main` æ¨¡å—é™¤å¤–ï¼Œå–å†³äºŽé¡¹ç›®é…ç½®ï¼‰ã€‚åœ¨è¿™ä¸ªç®€å•ä¾‹å­ä¸­ï¼Œæ¨¡å—ä½äºŽ `src` ç›®å½•çš„æœ€é«˜å±‚ï¼Œå› æ­¤æ¨¡å—åå°±æ˜¯æ–‡ä»¶ååŽ»æŽ‰åŽç¼€å³å¯ã€‚æ­¤å¤–ï¼Œæ¨¡å—å¯ä»¥å®šä¹‰**å¯¼å‡ºåˆ—è¡¨**ï¼ˆexport listï¼‰ï¼Œç”¨æ¥æŒ‡å®šå“ªäº›å®šä¹‰å¯ä»¥è¢«å…¶ä»–æ¨¡å—è®¿é—®ï¼Œå› ä¸ºæ¨¡å—ä¹Ÿå¯ä»¥å¯¼å…¥å…¶ä»–æ¨¡å—ã€‚è¿™ä¸ªæ–‡ä»¶å¯èƒ½é•¿è¿™æ ·ï¼š

**æ¸…å• 2.2 stack åˆ›å»ºçš„ç®€å•æ¨¡å—ç¤ºä¾‹**

```haskell
module Lib      --1
    ( someFunc  --2
    ) where

someFunc :: IO ()             --3
someFunc = putStrLn "someFunc"  --4
```

- `--1` å®šä¹‰æ¨¡å—å
- `--2` æŒ‡å®šå¯¼å‡ºåˆ—è¡¨
- `--3` ç»™å‡ºç±»åž‹ç­¾å
- `--4` æä¾›å‡½æ•°å®šä¹‰

è¿™ä¸ªæ¨¡å—æœ¬èº«æ²¡æœ‰å®žé™…ç”¨é€”ï¼Œåªæ˜¯ç”¨æ¥æ¼”ç¤ºæ¨¡å—å¦‚ä½•æž„å»ºã€‚æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªåä¸º `someFunc` çš„ IO æ“ä½œå®šä¹‰ï¼Œå®ƒè¢«æ¨¡å—ååŽçš„å¯¼å‡ºåˆ—è¡¨å¯¼å‡ºã€‚IO æ“ä½œçš„å…·ä½“å†…å®¹å°†åœ¨ç¬¬ 3 ç« è®²è§£ï¼Œç›®å‰æˆ‘ä»¬ä¸éœ€è¦å…³æ³¨ã€‚

------

å¯¼å…¥å…¶ä»–æ¨¡å—æœ€åŸºæœ¬çš„æ–¹æ³•æ˜¯ä½¿ç”¨ `import` è¯­å¥ã€‚å®ƒä¼šå¯¼å…¥æŒ‡å®šæ¨¡å—çš„æ‰€æœ‰å¯¼å‡ºå®šä¹‰ï¼ˆå¦‚æžœæ²¡æœ‰å¯¼å‡ºåˆ—è¡¨ï¼Œåˆ™å¯¼å…¥å…¨éƒ¨ï¼‰ã€‚è¿™ç§æ–¹å¼é€‚åˆå¯¼å…¥æä¾›ç‹¬ç‰¹å‡½æ•°çš„å·¥å…·æ¨¡å—ï¼Œä½†æœ‰å¯èƒ½å‡ºçŽ°åå­—å†²çªã€‚è¿™æ—¶å¯ä»¥åœ¨å‡½æ•°åå‰åŠ ä¸Šæ¨¡å—åï¼Œå¦‚ `ModuleName.x` æ¥æŒ‡å®šä½¿ç”¨å“ªä¸ªå®šä¹‰ã€‚

------

æŽ¥ä¸‹æ¥çœ‹çœ‹ `Main.hs`ï¼Œäº†è§£å¦‚ä½•å¯¼å…¥ `Lib` æ¨¡å—ä»¥åŠâ€œä¸»æ¨¡å—â€çš„æ ·å­ã€‚ä¸»æ¨¡å—åŒ…å« `main` æ“ä½œï¼Œæ˜¯ç¨‹åºçš„å…¥å£ã€‚æˆ‘ä»¬æš‚æ—¶ä¸å…³å¿ƒ `main` åšä»€ä¹ˆï¼Œåªéœ€æŠŠå®ƒå½“ä½œä¸€ä¸ªè¢«è°ƒç”¨çš„å‡½æ•°å³å¯ã€‚

**æ¸…å• 2.3 stack åˆ›å»ºçš„ç®€å• Main æ¨¡å—**

```haskell
module Main where
import Lib      --1

main :: IO ()  --2
main = someFunc
```

- `--1` å¯¼å…¥æ¨¡å—
- `--2` å®šä¹‰ä¸»æ“ä½œ

åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬æ‰€æœ‰å®žçŽ°éƒ½åœ¨ `Lib` æ¨¡å—ï¼Œå¹¶ç”¨ GHCi æµ‹è¯•ï¼Œå› æ­¤å¯ä»¥æš‚æ—¶å¿½ç•¥ `Main` æ¨¡å—ã€‚ä¸ºäº†è®©å¯æ‰§è¡Œæ–‡ä»¶èƒ½ç¼–è¯‘é€šè¿‡ï¼Œå¹¶é¿å… IDE æŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ `Main.hs` æ”¹ä¸ºåªæ‰“å° `Hello World`ï¼Œä¸å†å¯¼å…¥ `Lib`ï¼š

```haskell
module Main where

main :: IO ()
main = putStrLn "Hello World"
```

------

å›žåˆ° `Lib.hs`ï¼Œè¿›ä¸€æ­¥ç†Ÿæ‚‰ Haskellã€‚æˆ‘ä»¬å¯ä»¥å…ˆåˆ é™¤å¯¼å‡ºåˆ—è¡¨å’Œ `someFunc`ï¼Œæ¨¡å—å°±å˜æˆï¼š

```haskell
module Lib where
```

å¹²å‡€æ•´æ´â€”â€”ä¸€ä¸ªå…¨æ–°çš„å¼€å§‹ï¼æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ¨¡å—ä¸­å®šä¹‰å‡½æ•°ï¼Œè€Œä¸å¿…åœ¨ GHCi ä¸­é€è¡Œè¾“å…¥ã€‚

å®šä¹‰å‡½æ•°åŽï¼Œéœ€è¦æŠŠå®ƒåŠ å…¥å¯¼å‡ºåˆ—è¡¨ï¼Œè¿™æ ·å…¶ä»–æ¨¡å—æ‰èƒ½è®¿é—®ï¼š

```haskell
module Lib
  ( square,
  )
where

square :: Int -> Int
square x = x * x
```

ä¿å­˜æ–‡ä»¶åŽï¼Œå°±å¯ä»¥åŠ è½½æ¨¡å—äº†ã€‚æ–¹æ³•æ˜¯è¿›å…¥é¡¹ç›®ç›®å½•ï¼Œè¿è¡Œï¼š

```bash
stack repl
```

> **æ³¨æ„**
>  è®°å¾—æŠŠå¸Œæœ›è¢«å…¶ä»–æ¨¡å—è®¿é—®çš„å‡½æ•°å’Œç±»åž‹åŠ å…¥å¯¼å‡ºåˆ—è¡¨ï¼Œå¦åˆ™æ¨¡å—å¤–æ— æ³•æ‰¾åˆ°å®ƒä»¬ã€‚è™½ç„¶å¯ä»¥çœç•¥å¯¼å‡ºåˆ—è¡¨å¯¼å‡ºæ‰€æœ‰å®šä¹‰ï¼Œä½†è¿™è¢«è®¤ä¸ºæ˜¯ä¸è‰¯ç¼–ç é£Žæ ¼ï¼Œä¼šå¯¼è‡´ä»£ç éš¾ä»¥ç®¡ç†ã€‚

æ¨¡å—ä¼šè‡ªåŠ¨åŠ è½½ã€‚ä¹‹åŽï¼Œä½ å°±å¯ä»¥åœ¨æ–°æ‰“å¼€çš„ GHCi ä¸­ä½¿ç”¨è¿™äº›å‡½æ•°ã€‚è¯·ä¿æŒè¿™ä¸ª GHCi ä¼šè¯æ‰“å¼€ï¼Œå› ä¸ºæˆ‘ä»¬å°†ç”¨å®ƒè¿›è¡ŒåŽŸåž‹å¼€å‘ã€‚



## 2.2 å¸¸è§ç±»åž‹ä¸Žå¥‡å¦™å‡½æ•°ï¼ˆTypical types and fantastic functionsï¼‰

ä¸ºäº†è®©æˆ‘ä»¬çš„é¡¹ç›®ç»“æž„æ›´æ¸…æ™°ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æ€è€ƒè¦å¤„ç†çš„æ•°æ®ç±»åž‹ã€‚æ›´ç¡®åˆ‡åœ°è¯´ï¼Œå°±æ˜¯è¦è€ƒè™‘**æ•°æ®çš„ç±»åž‹ï¼ˆtypesï¼‰**ã€‚åœ¨ Haskell è¿™æ ·çš„è¯­è¨€ä¸­ï¼Œç±»åž‹è‡³å…³é‡è¦ã€‚ä¸Žä¸€äº›å…¶ä»–è¯­è¨€ç±»ä¼¼ï¼ŒHaskell æ˜¯**é™æ€ç±»åž‹è¯­è¨€ï¼ˆstatically typedï¼‰**â€”â€”ç±»åž‹åœ¨ç¼–è¯‘æ—¶å°±å·²ç»ç¡®å®šï¼Œè¿è¡Œæ—¶ä¸èƒ½åŠ¨æ€æ”¹å˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦å˜é‡æ‹¥æœ‰æŸç§ç±»åž‹ï¼Œåœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´è¿™ä¸ªç±»åž‹å°±ä¸ä¼šå˜åŒ–ã€‚æ­¤å¤–ï¼ŒHaskell è¿˜ä½¿ç”¨**ç±»åž‹æŽ¨å¯¼ï¼ˆtype inferenceï¼‰**ã€‚å¦‚æžœæ²¡æœ‰æ˜¾å¼åœ°å†™å‡ºç±»åž‹ï¼ŒHaskell ä¼šå°è¯•æ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨æŽ¨å¯¼ç±»åž‹ã€‚é€šå¸¸è¿™ç§æœºåˆ¶éžå¸¸å¯é ï¼Œä¸è¿‡åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æ˜¾å¼åœ°å‘Šè¯‰ Haskell æŸä¸ªè¡¨è¾¾å¼æˆ–å˜é‡çš„ç±»åž‹ã€‚æ­£å› ä¸ºæœ‰ç±»åž‹æŽ¨å¯¼æœºåˆ¶ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨ GHCi ä¸­è¾“å…¥çš„é‚£äº›å‡½æ•°å®šä¹‰ï¼Œå³ä½¿æ²¡å†™ç±»åž‹å£°æ˜Žï¼Œä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚

ç„¶è€Œï¼Œ**è‰¯å¥½çš„ç¼–ç¨‹é£Žæ ¼**æ˜¯ï¼šåœ¨æ¨¡å—çš„é¡¶å±‚å®šä¹‰ï¼ˆtop-level definitionsï¼‰ä¸­ï¼Œæ˜¾å¼åœ°å†™å‡ºç±»åž‹å£°æ˜Žã€‚è¿™å¯ä»¥é€šè¿‡**ç±»åž‹è¡¨è¾¾å¼ï¼ˆtype expressionï¼‰** æ¥å®žçŽ°ã€‚æœ€åŸºæœ¬çš„å½¢å¼å¦‚ä¸‹ï¼š

```haskell
name :: type
```

å®ƒè¡¨ç¤ºç»™æŸä¸ªåç§°ï¼ˆæˆ–ç§°æ ‡è¯†ç¬¦ï¼‰åˆ†é…ä¸€ä¸ªç±»åž‹ã€‚åç§°åªæ˜¯å€¼çš„ä¸€ä¸ªæ˜ å°„ï¼Œå› æ­¤è¿™å®žé™…ä¸Šæ˜¯åœ¨å£°æ˜ŽæŸä¸ªå€¼åº”è¯¥å…·æœ‰ä»€ä¹ˆç±»åž‹ã€‚é€šå¸¸ç±»åž‹è¡¨è¾¾å¼ä¼šç´§è·Ÿç€å…·ä½“çš„å®šä¹‰ï¼Œå°½ç®¡è¿™ä¸æ˜¯å¼ºåˆ¶è¦æ±‚ã€‚ç±»åž‹è¡¨è¾¾å¼æ˜¯ç¨‹åºä¸­**è¯­ä¹‰è¡¨è¾¾å¼ï¼ˆsemantic expressionsï¼‰**çš„ä¸€ä¸ªæœ‰è¶£è¡¥å……ã€‚æˆ‘ä»¬å·²ç»è§è¿‡è¯­ä¹‰è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ `x * x`ã€‚åœ¨æ±‚å€¼æ—¶ï¼Œè¿™ä¸ªè¡¨è¾¾å¼ä¼šäº§ç”Ÿä¸€ä¸ªå€¼ã€‚å¦‚æžœä¸€ä¸ªè¯­ä¹‰è¡¨è¾¾å¼å¸¦æœ‰ç±»åž‹è¡¨è¾¾å¼ï¼Œè¿™æ„å‘³ç€**äº§ç”Ÿçš„å€¼å…·æœ‰è¯¥ç±»åž‹è¡¨è¾¾å¼æŒ‡å®šçš„ç±»åž‹**ï¼Œè€Œä¸æ˜¯â€œè¯­ä¹‰è¡¨è¾¾å¼æœ¬èº«â€çš„ç±»åž‹ã€‚ç¨åŽåœ¨ç ”ç©¶å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬ä¼šæ›´æ¸…æ¥šåœ°çœ‹åˆ°è¿™ç§åŒºåˆ«ã€‚

------

### 2.2.1 åŽŸå­çº§åˆ«çš„ç±»åž‹ï¼ˆTypes on the atomic levelï¼‰

äº†è§£äº†ç±»åž‹è¡¨è¾¾å¼çš„åŸºæœ¬è¯­æ³•åŽï¼Œæˆ‘ä»¬å†çœ‹çœ‹ç±»åž‹çš„å®žé™…æ ·å­ã€‚æœ€ç®€å•çš„ç±»åž‹å°±æ˜¯**åŽŸå­ç±»åž‹ï¼ˆatomic typesï¼‰**ï¼Œå®ƒä»¬æ˜¯ç¨‹åºä¸­æœ€å¸¸ç”¨çš„ç±»åž‹ã€‚è¡¨ 2.1 åˆ—å‡ºäº†ä¸€äº›å¸¸è§çš„åŽŸå­ç±»åž‹ã€‚

| åç§° (Name) | æè¿° (Description) | ç¤ºä¾‹ (Examples)       |
| ----------- | ------------------ | --------------------- |
| **Bool**    | å¸ƒå°”çœŸå€¼           | `True`, `False`       |
| **Char**    | Unicode å­—ç¬¦       | `'a'`, `'A'`, `'1'`   |
| **Integer** | ä»»æ„ç²¾åº¦æ•´æ•°       | `-1`, `9999999`       |
| **Int**     | å›ºå®šç²¾åº¦æ•´æ•°       | `-1`, `10`            |
| **Float**   | å•ç²¾åº¦æµ®ç‚¹æ•°       | `3.1415`, `-1`, `1e2` |
| **Double**  | åŒç²¾åº¦æµ®ç‚¹æ•°       | `1e-2`, `9.99999`     |

å¯ä»¥çœ‹åˆ°ï¼Œä¸€äº›æ•°å€¼ç±»åž‹çš„ç¤ºä¾‹å€¼çœ‹èµ·æ¥æ˜¯ç›¸åŒçš„ã€‚å½“æˆ‘ä»¬ä½¿ç”¨è¿™äº›â€œæ¨¡æ£±ä¸¤å¯â€çš„å€¼æ—¶ï¼ŒHaskell çš„ç±»åž‹æŽ¨å¯¼æœºåˆ¶å°±ä¼šä»‹å…¥ï¼Œå°è¯•æŽ¨æ–­æ­£ç¡®çš„ç±»åž‹ã€‚

æœ‰äº†è¿™äº›ç±»åž‹çŸ¥è¯†åŽï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹æ€è€ƒå¦‚ä½•å®žçŽ°åŠ å¯†è½®çš„æ—‹è½¬ï¼ˆè§å›¾ 2.3ï¼‰ã€‚æ¯ä¸€æ¬¡è½®ç›˜æ—‹è½¬éƒ½æ˜¯ä»Žä¸€ä¸ªå­—æ¯ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå­—æ¯çš„ç¦»æ•£æ­¥éª¤ï¼Œå› æ­¤**åŠ å¯†å¯†é’¥**å¯ä»¥ç®€å•åœ°è¡¨ç¤ºä¸ºä¸€ä¸ª `Int`ã€‚æ¶ˆæ¯ç”±å­—æ¯ç»„æˆï¼Œå› æ­¤æ˜¯è‹¥å¹² `Char` å€¼çš„é›†åˆã€‚æˆ‘ä»¬è¦ç¼–å†™çš„å‡½æ•°å°†ä¸»è¦å¤„ç†è¿™äº›ç±»åž‹ã€‚

> ![figure2-3](/img/learn-haskell-by-example/chapter2/figure2-3.png)
>
> å›¾ 2.3â€ƒå­—æ¯æ›¿æ¢è½® 

éœ€è¦ç‰¹åˆ«æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼š**è¿™äº›åŽŸå­ç±»åž‹æœ¬èº«ä¹Ÿæ˜¯ç±»åž‹è¡¨è¾¾å¼ï¼**è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç»™å‡ºä¸€ä¸ªå±žäºŽè¯¥ç±»åž‹çš„å€¼ï¼ˆæˆ–è¯­ä¹‰è¡¨è¾¾å¼ï¼‰ï¼Œå½¢å¼å¦‚ä¸‹ï¼š

```haskell
kilo :: Int
kilo = 1000

mega :: Int
mega = kilo ^ (2 :: Int)

nano :: Double
nano = 1e-9
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸‰ä¸ªè¡¨ç¤ºå•ä½å‰ç¼€çš„å€¼ã€‚

- æˆ‘ä»¬å°†æ ‡è¯†ç¬¦ `kilo` å£°æ˜Žä¸ºç±»åž‹ `Int`ï¼Œè¿™å°±æ˜Žç¡®æŒ‡å®šäº†å®ƒæ˜¯ä¸€ä¸ªæ•´æ•°ã€‚
- è€Œ `nano` æ˜¯ä¸€ä¸ªç±»åž‹ä¸º `Double` çš„æµ®ç‚¹æ•°ã€‚
- `mega` çš„å®šä¹‰é€šè¿‡å¯¹ `kilo` è¿›è¡Œè¿ç®—ï¼ˆå³æŒ‡æ•°è¿ç®— `^`ï¼‰å¾—åˆ°ï¼Œå› æ­¤å®ƒå¿…é¡»ä¸Ž `kilo` å…·æœ‰ç›¸åŒçš„ç±»åž‹ã€‚

è¿™æ˜¯å› ä¸ºæ•°å€¼è¿ç®—ç¬¦é€šå¸¸**æŽ¥å—å¹¶è¿”å›žç›¸åŒç±»åž‹çš„å€¼**ã€‚

### 2.2.2 åˆ—è¡¨ä¸Žå…ƒç»„ï¼ˆLists and tuplesï¼‰

ä»…ä»…ä¾é ç®€å•çš„åŽŸå­ç±»åž‹ï¼Œè¿˜ä¸è¶³ä»¥æž„å»ºæœ‰ç”¨çš„æ•°æ®ç»“æž„ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æŸç§æ–¹å¼æ¥è¡¨ç¤º**ä¸€ç»„å­—æ¯çš„é›†åˆ**ã€‚å¹¸è¿çš„æ˜¯ï¼ŒHaskell æä¾›äº†ä¸€äº›æ›´å¤æ‚çš„ç±»åž‹ï¼Œæœ¬èŠ‚æˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»å®ƒä»¬ã€‚

ç¬¬ä¸€ä¸ªè¦ä»‹ç»çš„å°±æ˜¯ **åˆ—è¡¨**ã€‚åˆ—è¡¨æ˜¯ Haskellï¼ˆä»¥åŠè®¸å¤šå…¶ä»–å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼‰çš„æ ¸å¿ƒæž„å»ºå—ä¹‹ä¸€ã€‚å®ƒçš„æ¦‚å¿µéžå¸¸ç®€å•ï¼š**åˆ—è¡¨æ˜¯ä¸€ä¸ªåŒè´¨ï¼ˆhomogeneousï¼‰çš„å€¼åºåˆ—**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ å¿…é¡»å…·æœ‰ç›¸åŒçš„ç±»åž‹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡**ç”¨æ–¹æ‹¬å·åŒ…è£¹çš„é€—å·åˆ†éš”å€¼**æ¥å®šä¹‰åˆ—è¡¨ã€‚åˆ—è¡¨æ²¡æœ‰å›ºå®šé•¿åº¦ï¼Œå¯ä»¥åŠ¨æ€å¢žé•¿ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š

```haskell
intList :: [Int]
intList = [1, 2, 3]

boolList :: [Bool]
boolList = [True]

floatList :: [Float]
floatList = []

doubleList :: [Double]
doubleList = [1, 1 + 1, 1 + 2]
```

åˆ—è¡¨çš„ç±»åž‹è¡¨è¾¾å¼é€šè¿‡åœ¨æ–¹æ‹¬å·ä¸­åŒ…è£¹å¦ä¸€ç§ç±»åž‹è¡¨è¾¾å¼æ¥è¡¨ç¤ºã€‚ç”±äºŽåˆ—è¡¨çš„æ‰€æœ‰å…ƒç´ éƒ½å¿…é¡»æ˜¯åŒä¸€ç±»åž‹ï¼Œæ–¹æ‹¬å·ä¸­çš„ç±»åž‹è¡¨è¾¾å¼å°±ä»£è¡¨åˆ—è¡¨å†…éƒ¨å…ƒç´ çš„ç±»åž‹ã€‚åˆ—è¡¨ä¸­çš„æ‰€æœ‰å€¼ï¼ˆæˆ–èƒ½äº§ç”Ÿå€¼çš„è¡¨è¾¾å¼ï¼‰éƒ½å¿…é¡»å±žäºŽè¿™ä¸ªç±»åž‹ã€‚åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œå³ä½¿æ˜¯ä¸€ä¸ªç©ºåˆ—è¡¨ï¼ˆä¾‹å¦‚ `floatList`ï¼‰ï¼Œä¹Ÿå…·æœ‰ä¸€ä¸ªç¡®å®šçš„ç±»åž‹ã€‚åˆ—è¡¨çš„ç±»åž‹å‘Šè¯‰æˆ‘ä»¬ï¼š**è¯¥åˆ—è¡¨ä¸­å…ƒç´ çš„ç±»åž‹æ˜¯ä»€ä¹ˆ**ï¼Œä½†å®ƒå¹¶**ä¸ä¿è¯åˆ—è¡¨ä¸­ä¸€å®šå­˜åœ¨å…ƒç´ **ã€‚åœ¨ `doubleList` çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥çœ‹åˆ°åˆ—è¡¨ä¸­åŒ…å«çš„æ˜¯ä¸€äº›**è¡¨è¾¾å¼**ï¼ˆå¦‚ `1 + 2`ï¼‰ï¼Œè¿™äº›è¡¨è¾¾å¼åœ¨æ±‚å€¼åŽä¼šå˜æˆ `Double` ç±»åž‹çš„å€¼ã€‚è¿™é‡Œæˆ‘ä»¬è¿˜èƒ½çœ‹åˆ° **Haskell çš„ç±»åž‹æŽ¨å¯¼æœºåˆ¶**åœ¨èµ·ä½œç”¨ã€‚`doubleList` å¯ä»¥ç›´æŽ¥åœ¨ Haskell ç¨‹åºä¸­ä½¿ç”¨ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æŽ¨æ–­å‡ºå…¶ä¸­æ‰€æœ‰å…ƒç´ éƒ½æ˜¯ `Double` ç±»åž‹ã€‚ä½†é—®é¢˜æ˜¯ï¼š`1` è¿™ä¸ªå­—é¢å€¼ä¹Ÿå¯èƒ½æ˜¯ `Int` ç±»åž‹å‘€ï¼ŸHaskell ä¸ºä»€ä¹ˆä¼šçŸ¥é“å®ƒæ˜¯ `Double` å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼š**å› ä¸ºåˆ—è¡¨çš„ç±»åž‹è¢«æŒ‡å®šä¸º `[Double]`**ï¼Haskell å› æ­¤çŸ¥é“åˆ—è¡¨ä¸­çš„æ‰€æœ‰å€¼éƒ½å¿…é¡»æ˜¯ `Double` ç±»åž‹ã€‚

åˆ—è¡¨æ˜¯å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„â€œä¸»é£Ÿâ€æ•°æ®ç±»åž‹ã€‚ä¾‹å¦‚ **ML**ã€**Lisp**ï¼ˆâ€œlist interpreterâ€çš„ç¼©å†™ï¼‰ä»¥åŠå®ƒä»¬çš„è¡ç”Ÿè¯­è¨€ï¼Œéƒ½ä»¥åˆ—è¡¨ä½œä¸ºæ ¸å¿ƒæ•°æ®ç»“æž„ä¹‹ä¸€ã€‚å› æ­¤ï¼Œå­¦ä¹  Haskell ä¸­çš„åˆ—è¡¨ï¼Œä¹Ÿèƒ½å¸®åŠ©ä½ åœ¨è®¸å¤šå…¶ä»–è¯­è¨€ï¼ˆåŒ…æ‹¬éžå‡½æ•°å¼è¯­è¨€ï¼‰ä¸­ç†è§£ç±»ä¼¼çš„æ¦‚å¿µã€‚

å¦ä¸€ç§é‡è¦çš„æ•°æ®ç±»åž‹æ˜¯ **å…ƒç»„**ã€‚å®ƒä¸Žåˆ—è¡¨ç±»ä¼¼ï¼Œéƒ½æ˜¯ä¸€ç»„å€¼çš„åºåˆ—ï¼Œä½†æœ‰ä¸¤ä¸ªæ˜¾è‘—åŒºåˆ«ï¼š

1. **å…ƒç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„**ã€‚
2. **å…ƒç»„ä¸­çš„å…ƒç´ å¯ä»¥æœ‰ä¸åŒçš„ç±»åž‹**ã€‚

å…ƒç»„çš„å†™æ³•æ˜¯ï¼š**é€—å·åˆ†éš”çš„å€¼æ”¾åœ¨åœ†æ‹¬å·ä¸­**ã€‚ç±»åž‹è¡¨è¾¾å¼çš„å†™æ³•ä¸Žå€¼è¡¨è¾¾å¼ç±»ä¼¼ï¼Œå°±åƒåˆ—è¡¨é‚£æ ·ï¼š

```haskell
intPair :: (Int, Int)
intPair = (0, 1)

intFloatPair :: (Int, Float)
intFloatPair = (0, 1)

intCharDoubleTriple :: (Int, Char, Double)
intCharDoubleTriple = (1, 'a', 2)

septuple :: (Int, Float, Int, Float, Int, Float, Char)
septuple = (1, 1, 1, 1, 1, 1, 'a')
```

ä»Žè¿™äº›ä¾‹å­ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸åŒç±»åž‹çš„å€¼ç»„åˆåœ¨ä¸€èµ·å½¢æˆå¤æ‚çš„ç±»åž‹ã€‚å…ƒç»„çš„é•¿åº¦å¯ä»¥ä»»æ„ï¼ˆè‡³å°‘ä¸¤ä¸ªå…ƒç´ ï¼‰ï¼Œè€Œä¸”ä¸è¦æ±‚æ‰€æœ‰å…ƒç´ æ˜¯åŒä¸€ç±»åž‹ã€‚è¿™ç§ç±»åž‹åœ¨éœ€è¦**å°†ä¸åŒæ•°æ®å»ºç«‹å…³è”**æ—¶éžå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚å°†ä¸€ä¸ªæ•´æ•°ä¸Žä¸€ä¸ªå­—ç¬¦æˆ–æµ®ç‚¹æ•°é…å¯¹å­˜å‚¨ã€‚

### 2.2.3 å‡½æ•°ç±»åž‹ï¼ˆFunction typesï¼‰

çŽ°åœ¨æˆ‘ä»¬æ¥çœ‹æœ€åŽä¸€ç§ï¼ˆä¹Ÿè®¸æ˜¯æœ€é‡è¦çš„ï¼‰æ•°æ®ç±»åž‹ï¼š**å‡½æ•°**ã€‚æ²¡é”™ï¼Œå‡½æ•°æœ¬èº«å°±æ˜¯ä¸€ç§æ•°æ®ç±»åž‹ï¼ä¸ä»…å¦‚æ­¤ï¼Œ**å‡½æ•°åœ¨ Haskell ä¸­ä¹Ÿæ˜¯å€¼ï¼ˆvalueï¼‰**ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸»è¦ç¼–å†™çš„æ˜¯ä¸€äº›åŸºæœ¬çš„ã€ä¸»è¦æ˜¯æ•°å€¼ç±»åž‹çš„è¡¨è¾¾å¼å’Œå€¼ã€‚ä½†æˆ‘ä»¬è¿˜æ²¡æœ‰çœŸæ­£è§£é‡Šï¼Œä¸ºä»€ä¹ˆä¹‹å‰å®šä¹‰çš„ `square` å®žé™…ä¸Šä¼šå˜æˆä¸€ä¸ªå¯æ‰§è¡Œçš„å‡½æ•°ã€‚æœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª**å€¼**ï¼Œå¹¶å°†å®ƒä¸Žåç§° `square` å…³è”èµ·æ¥ã€‚

#### åŒ¿åå‡½æ•°ï¼ˆAnonymous functionsï¼‰

é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹å¦‚ä½•åœ¨ä¸å‘½åçš„æƒ…å†µä¸‹å®šä¹‰ä¸€ä¸ªå‡½æ•°ã€‚è¿™æ ·çš„å‡½æ•°è¢«ç§°ä¸º **åŒ¿åå‡½æ•°ï¼ˆanonymous functionï¼‰**ã€‚åœ¨ Haskell ä¸­ï¼Œå®ƒä»¬é€šè¿‡æ‰€è°“çš„ **lambda æŠ½è±¡ï¼ˆlambda abstractionï¼‰** è¡¨ç¤ºï¼Œå½¢å¼å¦‚ä¸‹ï¼š

```haskell
\x -> x * x
```

è¿™å…¶å®žå°±æ˜¯æˆ‘ä»¬ä¹‹å‰çš„å¹³æ–¹å‡½æ•°ã€‚å®ƒæŽ¥å—ä¸€ä¸ªå‚æ•° `x`ï¼Œå¹¶äº§ç”Ÿè¡¨è¾¾å¼ `x * x` çš„ç»“æžœã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠè¿™ä¸ªå‡½æ•°å€¼ç»‘å®šåˆ°ä¸€ä¸ªåå­—ä¸Šï¼š

```haskell
square = \x -> x * x
```

è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¹‹å‰çš„ `square` å‡½æ•°ã€‚å®ƒå…¶å®žä¸Žæˆ‘ä»¬åŽŸå…ˆçš„å®šä¹‰å®Œå…¨ç›¸åŒï¼Œåªæ˜¯å†™æ³•ä¸åŒè€Œå·²ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå€¼çš„ç±»åž‹ï¼š

```haskell
square :: Int -> Int
square = \x -> x * x
```

å¯ä»¥çœ‹åˆ°ï¼Œ**ç±»åž‹è¡¨è¾¾å¼çš„å½¢å¼å‡ ä¹Žä¸Žå‡½æ•°å®šä¹‰æœ¬èº«ç›¸ä¼¼**ã€‚å°±åƒå‡½æ•°æŠŠå˜é‡ï¼ˆä¾‹å¦‚ `x`ï¼‰æ˜ å°„åˆ°æŸä¸ªè¡¨è¾¾å¼ï¼ˆå¦‚ `x * x`ï¼‰ï¼Œç±»åž‹è¡¨è¾¾å¼ä¹Ÿè¯´æ˜Žäº†å‡½æ•°æ˜¯å¦‚ä½•å°†ä¸€ä¸ªç±»åž‹æ˜ å°„åˆ°å¦ä¸€ä¸ªç±»åž‹çš„ã€‚è¿™é‡Œçš„æ„æ€æ˜¯ï¼š`square` æŽ¥å—ä¸€ä¸ª `Int`ï¼Œè¿”å›žå¦ä¸€ä¸ª `Int`ã€‚

è¿™å°±æ˜¯ä¸€ä¸ª**ä¸€å…ƒå‡½æ•°ï¼ˆunary functionï¼‰**çš„ç±»åž‹è¡¨è¾¾å¼â€”â€”å®ƒåªæŽ¥å—ä¸€ä¸ªå‚æ•°ã€‚

#### å¤šå‚æ•°å‡½æ•°ï¼ˆCurried functionï¼‰

æˆ‘ä»¬å†çœ‹çœ‹å¦‚ä½•å®šä¹‰ä¸€ä¸ª**äºŒå…ƒå‡½æ•°**ï¼ˆæŽ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ï¼‰ï¼š

```haskell
add :: Int -> Int -> Int
add = \x -> \y -> x + y
```

åœ¨ Haskell ä¸­ï¼Œå¦‚æžœä¸€ä¸ªå‡½æ•°æŽ¥æ”¶ä¸€ä¸ªå˜é‡å¹¶è¿”å›žä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨è¾¾å¼ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨â€œå†…å±‚â€å‡½æ•°å¤–åŠ æ‹¬å·æ¥æ›´æ¸…æ™°åœ°çœ‹åˆ°è¿™ä¸€ç‚¹ï¼š

```haskell
add :: Int -> (Int -> Int)
add = \x -> (\y -> x + y)
```

ä¸è¿‡è¿™ç§å†™æ³•æ˜¾å¾—æ—¢å•°å—¦åˆéš¾è¯»ï¼Œæ‰€ä»¥ Haskell æä¾›äº†**è¯­æ³•ç³–ï¼ˆsyntactic sugarï¼‰**ï¼Œè®©æˆ‘ä»¬èƒ½æ›´ç®€æ´åœ°ä¹¦å†™å‡½æ•°ï¼š

```haskell
add :: Int -> Int -> Int
add = \x y -> x + y
```

æˆ‘ä»¬çœ‹åˆ°ï¼ŒçŽ°åœ¨çš„ lambda æŠ½è±¡ä¸€æ¬¡æ€§æŽ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç”šè‡³æˆ‘ä»¬è¿˜å¯ä»¥å†è¿›ä¸€æ­¥ç®€åŒ–â€”â€”ç›´æŽ¥æŠŠå‚æ•°å†™åœ¨å‡½æ•°ååŽé¢ï¼š

```haskell
add :: Int -> Int -> Int
add x y = x + y
```

è¿™å°±æ˜¯æˆ‘ä»¬åœ¨ Haskell ä¸­æœ€å¸¸ç”¨çš„å‡½æ•°å®šä¹‰æ–¹å¼ã€‚å¯ä»¥çœ‹å‡ºï¼Œlambda æŠ½è±¡ä¸­çš„å‚æ•°å¯ä»¥â€œç§»â€åˆ°å‡½æ•°ååŽé¢ã€‚åœ¨è®¸å¤šå…¶ä»–è¯­è¨€ä¸­ï¼Œå‡½æ•°çš„ç±»åž‹é€šå¸¸å†™ä½œ**å‚æ•°ç±»åž‹ + è¿”å›žç±»åž‹**çš„ç»„åˆã€‚Haskell çš„å‡½æ•°ç±»åž‹è¡¨è¾¾å¼å…¶å®žä¹Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼šå‰é¢çš„ç±»åž‹ä»£è¡¨å‚æ•°ç±»åž‹ï¼Œè€Œæœ€åŽä¸€ä¸ªç±»åž‹ä»£è¡¨å‡½æ•°**â€œè¿”å›žå€¼â€**çš„ç±»åž‹ã€‚è¿™ä¸€ç‚¹åœ¨ **å›¾ 2.4** ä¸­æœ‰æ¸…æ¥šçš„ç¤ºæ„ã€‚ä¸è¿‡è¿™é‡Œçš„ â€œreturnâ€ ä¸€è¯è¢«ç‰¹æ„åŠ ä¸Šäº†å¼•å·ã€‚è¿™æ˜¯å› ä¸ºåœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œ**æˆ‘ä»¬ä¸åº”æŠŠå‡½æ•°ç†è§£ä¸ºâ€œè¿”å›žâ€æŸä¸ªå€¼**â€”â€”å‡½æ•°**åªæ˜¯è¢«æ±‚å€¼ï¼ˆevaluatedï¼‰ä¸ºæŸä¸ªå€¼**ã€‚

> ![figure2-4](/img/learn-haskell-by-example/chapter2/figure2-4.png)
>
> å›¾ 2.4ï¼šä¸€ä¸ªå‡½æ•°çš„ç±»åž‹è¡¨è¾¾å¼ç¤ºä¾‹åŠå…¶å¯¹åº”çš„å®šä¹‰



### 2.2.4 ç»™æ•°å­¦è¿ç®—åŠ ä¸Šç±»åž‹ï¼ˆAdding types to mathï¼‰

çŽ°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº†ç±»åž‹æ˜¯å¦‚ä½•ä¹¦å†™çš„ï¼Œå¯ä»¥çœ‹åˆ° `Int -> Int` æ˜¯ `square` å‡½æ•°çš„ä¸€ä¸ªåˆæ³•ç±»åž‹ã€‚ä½†ä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ `Int` è€Œä¸æ˜¯å…¶ä»–æ•°å€¼ç±»åž‹å‘¢ï¼Ÿå…¶å®žï¼Œæ²¡æœ‰ç‰¹åˆ«çš„ç†ç”±ï¼›ç„¶è€Œï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½éšæ„æ›´æ”¹ç±»åž‹ã€‚`(*)` è¿ç®—ç¬¦å¯ä»¥ä½œç”¨äºŽæ‰€æœ‰æ•°å€¼ç±»åž‹ï¼Œä½†å®ƒè¦æ±‚**ä¸¤ä¸ªå‚æ•°çš„ç±»åž‹å¿…é¡»ç›¸åŒ**ã€‚å¦‚æžœæˆ‘ä»¬ç»™å‡½æ•°ä¼ å…¥ä¸åŒç±»åž‹çš„å€¼ï¼Œå°±ä¼šé‡åˆ°ç±»åž‹é”™è¯¯ï¼š

```haskell
ghci> a = 1 :: Int        -- #1
ghci> b = 2 :: Double     -- #2
ghci> a * b
<interactive>:4:5: error:
    â€¢ Couldn't match expected type 'Int' with actual type 'Double'
    â€¢ In the second argument of '(*)', namely 'b'
      In the expression: a * b
      In an equation for 'it': it = a * b
```

- \#1 æŒ‡å®šå˜é‡ `a` çš„ç±»åž‹ä¸º `Int`
- \#2 æŒ‡å®šå˜é‡ `b` çš„ç±»åž‹ä¸º `Double`

é”™è¯¯ä¿¡æ¯æ­£å¦‚æˆ‘ä»¬é¢„æœŸçš„é‚£æ ·ï¼šè¡¨è¾¾å¼ `a * b` äº§ç”Ÿäº†ç±»åž‹é”™è¯¯ï¼Œå› ä¸ºä½¿ç”¨ `a`ï¼ˆç±»åž‹ä¸º `Int`ï¼‰ä¼šå¼ºåˆ¶ `b` ä¹Ÿå¿…é¡»æ˜¯ `Int` ç±»åž‹ï¼Œè€Œå®žé™…ä¸Š `b` æ˜¯ `Double`ã€‚

å›žæƒ³æˆ‘ä»¬çš„åŠ å¯†ç®—æ³•ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥æŽ¨æµ‹éœ€è¦ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒèƒ½å°†å•ä¸ªå­—ç¬¦æŒ‰æŒ‡å®šçš„åç§»é‡è¿›è¡Œæ—‹è½¬ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç±»åž‹ä¸º `Int -> Char -> Char` çš„å‡½æ•°ã€‚ä¸è¿‡ï¼Œç”±äºŽæˆ‘ä»¬å¿…é¡»åˆ†åˆ«å¤„ç†å°å†™å­—æ¯å’Œå¤§å†™å­—æ¯ï¼Œæ‰€ä»¥è¿˜éœ€è¦è€ƒè™‘å¦‚ä½•è¡¨ç¤ºæˆ‘ä»¬æ‰€ä½¿ç”¨çš„å­—ç¬¦é›†å’Œå­—æ¯è¡¨ã€‚



## 2.3 å…³äºŽå­—æ¯è¡¨çš„ä¸€ç‚¹å¸®åŠ©ï¼ˆA little help with the alphabetï¼‰

ä¸ºäº†å®žçŽ°æˆ‘ä»¬çš„ç®—æ³•ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ·±å…¥åœ°æ€è€ƒå‡¯æ’’å¯†ç æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚æ­£å¦‚å›¾ 2.5 æ‰€ç¤ºï¼Œæˆ‘ä»¬å°†æ¯ä¸ªå­—æ¯æ›¿æ¢ä¸ºå¦ä¸€ä¸ªå­—æ¯ï¼Œå› æ­¤è¿™ç§åŠ å¯†æ–¹æ³•è¢«ç§°ä¸ºæ›¿æ¢å¯†ç ã€‚æ—¢ç„¶æˆ‘ä»¬è¦å®žçŽ°è¿™ä¸ªå¯†ç ï¼Œå°±å¿…é¡»é—®ä¸€ä¸ªé‡è¦é—®é¢˜ï¼šæˆ‘ä»¬å¦‚ä½•å¤„ç†å­—æ¯å’Œå­—æ¯è¡¨ï¼Ÿ

> 
>
> ![figure2-5](/img/learn-haskell-by-example/chapter2/figure2-5.png)
>
> å›¾ 2.5 å‡¯æ’’å¯†ç æ¦‚è§ˆ

æˆ‘ä»¬å·²ç»å¼€å§‹è€ƒè™‘æˆ‘ä»¬è¦å¤„ç†çš„æ•°æ®ç±»åž‹ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–¹æ³•æ¥æŒ‡å®šåç§»é‡ï¼Œå®ƒå¯ä»¥æ˜¯æ­£æ•°ä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•°ï¼Œå› æ­¤ `Int` ç±»åž‹å¯èƒ½å°±å¤Ÿç”¨äº†ã€‚æ¶ˆæ¯ç”±ä¸€äº›å­—æ¯ç»„æˆï¼Œæ‰€ä»¥ä½¿ç”¨ `String` ç±»åž‹å¯èƒ½æ¯”è¾ƒåˆé€‚ã€‚

------

### 2.3.1 ä¸ºå¯è¯»æ€§å®šä¹‰åŒä¹‰ç±»åž‹ï¼ˆSynonymous types for readabilityï¼‰

ç­‰ç­‰ï¼Œ`String`ï¼Ÿæˆ‘ä»¬ä¹‹å‰æ²¡è§è¿‡è¿™ä¸ªç±»åž‹ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å®žé™…ä¸Šå·²ç»éšå¼ä½¿ç”¨è¿‡å®ƒäº†ã€‚Haskell ä¸­ `String` çš„å®Œæ•´å®šä¹‰å¦‚ä¸‹ï¼š

```haskell
type String = [Char]
```

`type` å…³é”®å­—å®šä¹‰äº†ä¸€ä¸ªç±»åž‹çš„ç®€å•åŒä¹‰è¯ã€‚å› æ­¤ï¼Œ`String` åªæ˜¯ `[Char]` çš„åˆ«åã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å®šä¹‰ä¸€ä¸ª `String` å€¼å‘¢ï¼Ÿ

```haskell
string1 :: String
string1 = "Hello World"

string2 :: String
string2 = ['H', 'e', 'l', 'l', 'o', ' ', 'W', 'o', 'r', 'l', 'd']
```

Haskell å’Œè®¸å¤šå…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œä¸ºå­—ç¬¦ä¸²æä¾›äº†æ˜¾å¼è¯­æ³•ï¼Œè¿™åªæ˜¯ä¹¦å†™å­—ç¬¦åˆ—è¡¨çš„ä¸€ç§æ›´æ¼‚äº®çš„æ–¹å¼ã€‚ä¸Šè¿°ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚

çŽ°åœ¨æˆ‘ä»¬çŸ¥é“è¦å¤„ç†çš„ç±»åž‹ï¼Œå¯ä»¥å¼€å§‹è€ƒè™‘å®žçŽ°ç®—æ³•æ‰€éœ€çš„åŠŸèƒ½ã€‚æ— è®ºæœ€ç»ˆæ–¹æ¡ˆå¦‚ä½•ï¼Œæˆ‘ä»¬éœ€è¦çš„å‡½æ•°éƒ½å¿…é¡»èƒ½å¤Ÿä¸ºå•ä¸ªå­—ç¬¦ç”Ÿæˆæ›¿æ¢å­—ç¬¦ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›å·¥å…·å‡½æ•°æ¥ç®€åŒ–æ“ä½œã€‚åœ¨åŠ å¯†æ¶ˆæ¯æ—¶ï¼ŒçŸ¥é“æˆ‘ä»¬æ­£åœ¨å¤„ç†çš„å­—ç¬¦ç±»åž‹éžå¸¸æœ‰å¸®åŠ©ã€‚æˆ‘ä»¬å¸Œæœ›å‡½æ•°èƒ½å¤Ÿåˆ¤æ–­å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ˜¯å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—è¿˜æ˜¯å…¶ä»–å­—ç¬¦ï¼Œå…¶ç±»åž‹å¯ä»¥å¦‚ä¸‹æ‰€ç¤ºï¼š

```haskell
isUpper :: Char -> Bool
isLower :: Char -> Bool
isDigit :: Char -> Bool
isMisc  :: Char -> Bool
```

å®žçŽ°è¿™äº›å‡½æ•°éœ€è¦æˆ‘ä»¬åˆ¤æ–­ä¸€ä¸ª `Char` æ˜¯å¦å±žäºŽæŸä¸ªå­—ç¬¦é›†åˆã€‚æˆ‘ä»¬ç§°è¿™äº›é›†åˆä¸ºå­—æ¯è¡¨ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸€ä¸ªå­—æ¯è¡¨çš„ç±»åž‹åŒä¹‰è¯ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å­—ç¬¦åˆ—è¡¨ï¼š

```haskell
type Alphabet = [Char]
```
æ³¨æ„ï¼Œå­—ç¬¦ä¸²å’Œå­—æ¯è¡¨çš„ç±»åž‹å®Œå…¨ç›¸åŒï¼Œä½†ç±»åž‹çš„ä½œç”¨æ˜¯è¡¨ç¤ºè¯¥å€¼çš„ç”¨é€”ã€‚`String` ç”¨äºŽæ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œé€šå¸¸è¡¨ç¤ºå¯è¯»æ–‡æœ¬ï¼Œè€Œå­—æ¯è¡¨ç±»åž‹æ„å‘³ç€å®ƒè¡¨ç¤ºæˆ‘ä»¬è¦åœ¨æ›¿æ¢å¯†ç ä¸­ä½¿ç”¨çš„å­—ç¬¦é›†åˆï¼Œå¯ä»¥åƒå›¾ 2.1 æ‰€ç¤ºé‚£æ ·æ—‹è½¬ã€‚
æœ‰äº†å­—æ¯è¡¨ç±»åž‹åŽï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹å®šä¹‰å­—æ¯è¡¨ã€‚ä¾‹å¦‚ï¼Œå®šä¹‰å°å†™æ‹‰ä¸å­—æ¯è¡¨ï¼š

```haskell
lowerAlphabet :: Alphabet
lowerAlphabet = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j',
                 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 
                 'u', 'v', 'w', 'x', 'y', 'z']
```

ä¸è¿‡ï¼Œè¿™æ ·å†™æ¯”è¾ƒç¹çã€‚å¹¸è¿çš„æ˜¯ï¼ŒHaskell æ”¯æŒèŒƒå›´è¯­æ³•ï¼ˆrangeï¼‰ï¼š

```haskell
ghci> [1 .. 10 :: Int]
[1,2,3,4,5,6,7,8,9,10]
ghci> [1, 5 .. 100 :: Int]
[1,5,9,13,17,21,25,29,33,37,41,45,49,53,57,61,65,69,73,77,81,85,89,93,97]
ghci> [0, -2 .. -10 :: Int]
[0,-2,-4,-6,-8,-10]
```

èŒƒå›´è¯­æ³•è¿˜æ”¯æŒæ­¥é•¿ï¼Œå¹¶ä¸”åŒæ ·é€‚ç”¨äºŽ `Char` ç±»åž‹ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æ›´ç®€æ´åœ°å®šä¹‰å­—æ¯è¡¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ˆè§æ¸…å• 2.4ï¼‰ï¼š

**æ¸…å• 2.4 ä¸åŒæ‹‰ä¸å­—æ¯è¡¨å’Œæ•°å­—çš„å®šä¹‰**

```haskell
lowerAlphabet :: Alphabet
lowerAlphabet = ['a' .. 'z']

upperAlphabet :: Alphabet
upperAlphabet = ['A' .. 'Z']

digits :: Alphabet
digits = ['0' .. '9']
```

ç¡®ä¿ä½ çš„ GHCi ä¼šè¯ä»ç„¶æ‰“å¼€ï¼Œå› ä¸ºçŽ°åœ¨å¯ä»¥æ£€æŸ¥è¿™äº›å­—æ¯è¡¨ï¼åœ¨ `Lib.hs` ä¸­ä¿å­˜è¿™äº›å®šä¹‰åŽï¼Œé‡æ–°åŠ è½½ GHCiï¼š

```haskell
ghci> :reload          -- #1
[3 of 3] Compiling Lib ( .../src/Lib.hs, interpreted )
Ok, three modules loaded.

ghci> lowerAlphabet
"abcdefghijklmnopqrstuvwxyz"
ghci> upperAlphabet
"ABCDEFGHIJKLMNOPQRSTUVWXYZ"
ghci> digits
"0123456789"
```

- \#1 `:reload` ä¼šé‡æ–°åŠ è½½æ¨¡å—ï¼Œä½¿æ¨¡å—ä¸­çš„æ–°å®šä¹‰ç«‹å³å¯ç”¨

å¦‚æžœä¹‹å‰å…³é—­äº† GHCiï¼Œä¼šè¯ä¹Ÿæ²¡å…³ç³»ï¼Œåªéœ€åœ¨ `Lib.hs` ä¿å­˜å­—æ¯è¡¨å®šä¹‰ï¼Œç„¶åŽåœ¨é¡¹ç›®ç›®å½•ä¸‹å†æ¬¡æ‰§è¡Œ `stack repl` å³å¯ã€‚

> âš ï¸ è­¦å‘Šï¼šåœ¨ GHCi ä¸­ä½¿ç”¨ `:reload` æ—¶ï¼Œæ‰€æœ‰æœ¬åœ°å®šä¹‰å’Œå˜é‡éƒ½ä¼šè¢«åˆ é™¤ï¼è¯¥å‘½ä»¤ç›¸å½“äºŽå…³é—­å¹¶é‡æ–°æ‰“å¼€ GHCiã€‚


å¦‚ä½ æ‰€è§ï¼Œå­—æ¯è¡¨åŒ…å«äº†æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰å­—ç¬¦ã€‚ä½†ä¸ºä»€ä¹ˆå®ƒä»¬è¢«æ‰“å°ä¸º `String`ï¼Ÿæˆ‘ä»¬ä¸æ˜¯æŒ‡å®šäº†è‡ªå®šä¹‰çš„å­—æ¯è¡¨ç±»åž‹å—ï¼Ÿåœ¨ GHCi ä¸­ä½¿ç”¨ `:type` å‘½ä»¤æ£€æŸ¥ï¼š

```haskell
ghci> :type lowerAlphabet
lowerAlphabet :: Alphabet
ghci> :type upperAlphabet
upperAlphabet :: Alphabet
ghci> :type digits
digits :: Alphabet
```

ç¡®å®žï¼Œå®ƒä»¬æ˜¯è‡ªå®šä¹‰ç±»åž‹ã€‚ç”±äºŽå­—æ¯è¡¨æ˜¯ `Char` åˆ—è¡¨çš„åŒä¹‰è¯ï¼Œå¹¶ä¸”å‡ ä¹Žæ€»æ˜¯ä½œä¸º `String` ä½¿ç”¨ï¼Œå› æ­¤ Haskell é»˜è®¤å°†å…¶æ‰“å°ä¸º `String`ã€‚

ä½¿ç”¨ç±»åž‹åŒä¹‰è¯å¯ä»¥äº’æ¢ï¼Œä½†å®ƒçš„ä¸»è¦ç›®çš„åœ¨äºŽ**å¯è¯»æ€§**ï¼šå¦‚æžœä¸€ä¸ªå‡½æ•°çš„å‚æ•°ç±»åž‹æ˜¯ `Alphabet`ï¼Œæˆ‘ä»¬å°±èƒ½æŽ¨æ–­å‡ºè¯¥å‡½æ•°ä¼šä»¥ç‰¹å®šæ–¹å¼å¤„ç†è¿™äº›å­—ç¬¦ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥æŽ¨æ–­å‡½æ•°æ˜¯ä¸ºäº†åŠ å¯†ç®—æ³•è€Œç¼–å†™çš„ã€‚


#### FilePath ç±»åž‹

æ ‡å‡†åº“ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„å¯è¯»æ€§ç”¨æ³•ã€‚ä¾‹å¦‚ï¼Œ`FilePath` ç±»åž‹ç”¨äºŽè¡¨ç¤ºæ–‡ä»¶è·¯å¾„ï¼Œä½†åœ¨ GHCi ä¸­æŸ¥çœ‹æ—¶ä¼šå‘çŽ°ï¼š

```haskell
ghci> :info FilePath
type FilePath :: *
type FilePath = String
        -- Defined in 'GHC.IO'
```

è¿™ä¸ªç‰¹æ®Šç±»åž‹æœ¬è´¨ä¸Šå°±æ˜¯æ™®é€šçš„ `String`ï¼ˆä¹Ÿå°±æ˜¯ `[Char]`ï¼‰ï¼Œä½†å®ƒå¯ä»¥æé«˜å‡½æ•°çš„å¯è¯»æ€§ï¼šå¦‚æžœä¸€ä¸ªå‡½æ•°å‚æ•°æ˜¯ `FilePath`ï¼Œå°±æ›´æ¸…æ¥šå®ƒæœŸæœ›çš„ `String` æ ¼å¼æ˜¯ä»€ä¹ˆã€‚

ä½¿ç”¨ `:info` å¯ä»¥æŸ¥çœ‹ç±»åž‹çš„å®šä¹‰å’Œæ¥æºã€‚

> ðŸ’¡ æç¤ºï¼š`:reload`ã€`:type` å’Œ `:info` åˆ†åˆ«å¯ä»¥ç®€å†™ä¸º `:r`ã€`:t` å’Œ `:i`ã€‚

### 2.3.2 å­—æ¯çš„ç±»åž‹ï¼ˆThe kinds of lettersï¼‰

 æ—¢ç„¶æˆ‘ä»¬å·²ç»æœ‰äº†å­—æ¯è¡¨ï¼ŒçŽ°åœ¨å¯ä»¥å¼€å§‹ç¼–å†™åˆ¤æ–­å­—ç¬¦æ˜¯å¦å±žäºŽæŸä¸ªå­—æ¯è¡¨çš„å‡½æ•°äº†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåä¸º `elem` çš„å‡½æ•°ã€‚`elem` æ˜¯ä¸€ä¸ªäºŒå…ƒå‡½æ•°ï¼Œéœ€è¦ä¸¤ä¸ªå‚æ•°ï¼šå…ƒç´ æœ¬èº«ä»¥åŠæˆ‘ä»¬æƒ³è¦æ£€æŸ¥çš„åˆ—è¡¨ã€‚å¦‚æžœå…ƒç´ å­˜åœ¨äºŽåˆ—è¡¨ä¸­ï¼Œå®ƒå°†è¿”å›ž `True`ï¼Œå¦åˆ™è¿”å›ž `False`ã€‚ç”±äºŽæˆ‘ä»¬çš„å­—æ¯è¡¨ç±»åž‹ `Alphabet` æ˜¯ `[Char]` çš„åŒä¹‰è¯ï¼Œæ‰€ä»¥å¯ä»¥åœ¨å­—æ¯è¡¨ä¸Šä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š

```haskell
ghci> elem 'a' lowerAlphabet
True
ghci> elem 'a' upperAlphabet
False
ghci> elem '1' lowerAlphabet
False
ghci> elem '1' digits
True
```

Haskell æä¾›äº†ä¸€ç§è¯­æ³•å°æŠ€å·§æ¥å¢žå¼ºäºŒå…ƒå‡½æ•°çš„å¯è¯»æ€§ï¼š

```haskell
ghci> 'a' `elem` lowerAlphabet
True
```

ä»»ä½•äºŒå…ƒå‡½æ•°éƒ½å¯ä»¥ä½¿ç”¨åå¼•å·å†™æˆä¸­ç¼€è¡¨ç¤ºæ³•ï¼çŽ°åœ¨æˆ‘ä»¬å¯ä»¥åƒè¯»ä¸€å¥è¯ä¸€æ ·ç†è§£ä»£ç ï¼šâ€œ`a` æ˜¯å°å†™å­—æ¯è¡¨ä¸­çš„å…ƒç´ å—ï¼Ÿâ€

å°†è¿™äº›å‡½æ•°ç»„åˆèµ·æ¥ï¼Œä»£ç å¦‚ä¸‹ï¼š

**æ¸…å• 2.5 æ£€æŸ¥å­—æ¯è¡¨æˆå‘˜çš„è¾…åŠ©å‡½æ•°**

```haskell
isLower :: Char -> Bool
isLower char = char `elem` lowerAlphabet   #1

isUpper :: Char -> Bool
isUpper char = char `elem` upperAlphabet     #2

isDigit :: Char -> Bool
isDigit char = char `elem` digits    #3
```

- \#1 å¦‚æžœå­—ç¬¦æ˜¯å°å†™å­—æ¯åˆ™è¿”å›ž `True`
- \#2 å¦‚æžœå­—ç¬¦æ˜¯å¤§å†™å­—æ¯åˆ™è¿”å›ž `True`
- \#3 å¦‚æžœå­—ç¬¦æ˜¯æ•°å­—åˆ™è¿”å›ž `True`

åœ¨ GHCi ä¸­æµ‹è¯•è¿™äº›å‡½æ•°ï¼š

```haskell
ghci> :r
[3 of 3] Compiling Lib              (.../src/Lib.hs, interpreted )
Ok, three modules loaded.
ghci> isLower 'a'
True
ghci> isLower 'A'
False
ghci> isUpper 'A'
True
ghci> isDigit '5'
True
```

### 2.3.3 é€»è¾‘ç»„åˆï¼ˆLogical combinationsï¼‰

 é‚£å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦æ˜¯â€œæ‚é¡¹â€ï¼ˆå³ä¸å±žäºŽä»»ä½•å­—æ¯è¡¨ï¼‰å‘¢ï¼Ÿå¯ä»¥ä½¿ç”¨å¸ƒå°”è¿ç®—ç¬¦ï¼š

```haskell
isMisc :: Char -> Bool
isMisc char = not (isUpper char || isLower char || isDigit char)
```

å¸ƒå°”è¿ç®—ç¬¦æœ‰é€»è¾‘æˆ– (`||`)ã€é€»è¾‘ä¸Ž (`&&`) å’Œé€»è¾‘éž (`not`)ï¼Œå®ƒä»¬çš„ç±»åž‹å¦‚ä¸‹ï¼š

```haskell
ghci> :type not
not :: Bool -> Bool
ghci> :type (||)
(||) :: Bool -> Bool -> Bool
ghci> :type (&&)
(&&) :: Bool -> Bool -> Bool
```

åœ¨ Haskell ä¸­ï¼Œè¿ç®—ç¬¦æœ¬è´¨ä¸Šæ˜¯å‡½æ•°ï¼Œä½¿ç”¨æ‹¬å·å¯ä»¥å°†å®ƒä»¬è§£é‡Šä¸ºå‡½æ•°ï¼Œä¹Ÿå¯ä»¥å†™æˆå‰ç¼€å½¢å¼ï¼š

```haskell
ghci> (||) False True
True
ghci> (+) 1 2
3
```

å›žåˆ° `isMisc` å‡½æ•°ï¼Œè™½ç„¶æ­£ç¡®ï¼Œä½†ä¸æ˜“æ‰©å±•ã€‚å¦‚æžœå°†æ¥å¢žåŠ æ–°çš„å­—æ¯è¡¨ï¼Œå°±å¿…é¡»å†™é¢å¤–çš„è¾…åŠ©å‡½æ•°å¹¶æ·»åŠ åˆ°é€»è¾‘æˆ–ä¸­ã€‚æ›´å¥½çš„æ–¹æ³•æ˜¯æ£€æŸ¥å­—ç¬¦æ˜¯å¦ä¸å±žäºŽæ‰€æœ‰å·²æœ‰å­—æ¯è¡¨ã€‚è¿™æ—¶å¯ä»¥ä½¿ç”¨åˆ—è¡¨çš„è¿½åŠ è¿ç®—ç¬¦ `(++)`ï¼š

```haskell
ghci> [1,2,3] ++ [4,5,6]
[1,2,3,4,5,6]
ghci> "Hello" ++ " " ++ "World!"
"Hello World!"
```

æ³¨æ„ï¼Œè¿™ä¸ªè¿ç®—ç¬¦åŒæ ·é€‚ç”¨äºŽå­—ç¬¦ä¸²ï¼Œå› ä¸ºå­—ç¬¦ä¸²æœ¬è´¨ä¸Šå°±æ˜¯å­—ç¬¦åˆ—è¡¨ï¼æ­¤å¤–ï¼Œè¿˜æœ‰ `notElem` å‡½æ•°ï¼Œå®ƒæ˜¯ `elem` çš„å¦å®šå½¢å¼ã€‚ç»“åˆä½¿ç”¨åŽï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹ä»£ç ï¼š

**æ¸…å• 2.6 åˆ¤æ–­å­—ç¬¦æ˜¯å¦æ—¢ä¸æ˜¯å­—æ¯ä¹Ÿä¸æ˜¯æ•°å­—çš„è¾…åŠ©å‡½æ•°**

```haskell
isMisc :: Char -> Bool
isMisc char = char `notElem` lowerAlphabet ++ upperAlphabet ++ digits   #1
```

- \#1 å¦‚æžœå­—ç¬¦ä¸å±žäºŽå°å†™å­—æ¯ã€å¤§å†™å­—æ¯æˆ–æ•°å­—ï¼Œåˆ™è¿”å›ž `True`

è¿™æ ·ä¸€æ¥ï¼Œæ‰©å±•å‡½æ•°ä»¥æ”¯æŒæ›´å¤šå­—æ¯è¡¨æˆ–å…¶ä»–ä¸è¢«è§†ä¸ºæ‚é¡¹çš„å­—ç¬¦ï¼Œåªéœ€å°†æ–°çš„å­—ç¬¦åˆ—è¡¨è¿½åŠ åˆ°è¡¨è¾¾å¼ä¸­å³å¯ã€‚



## 2.4 æ—‹è½¬è½¬ç›˜ï¼ˆRotating the wheelï¼‰

çŽ°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†è¾…åŠ©å‡½æ•°ï¼Œå¯ä»¥å¼€å§‹è€ƒè™‘å¦‚ä½•å®žçŽ°å‡¯æ’’å¯†ç äº†ã€‚é‡ç‚¹æ˜¯ç†è§£å¦‚ä½•åœ¨ç®—æ³•ä¸­è¿›è¡Œç®€æ´ä¸”æ°å½“çš„å¤§å°å†™åŒºåˆ†ã€‚

æŽ¥ä¸‹æ¥éœ€è¦å®Œæˆçš„æ­¥éª¤ï¼š

1. èŽ·å–å­—æ¯åœ¨å­—æ¯è¡¨ä¸­çš„ç´¢å¼•ã€‚
2. èŽ·å–å­—æ¯è¡¨ä¸­æŸä¸ªç´¢å¼•å¯¹åº”çš„å­—æ¯ã€‚
3. å¯¹å­—ç¬¦ä¸²é€å­—ç¬¦è¿›è¡Œè½¬æ¢ã€‚

------

### 2.4.1 æŸ¥æ‰¾å…ƒç´ çš„ç´¢å¼•ï¼ˆFinding an elementâ€™s indexï¼‰

é¦–å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªå­ä»»åŠ¡ï¼šæŸ¥æ‰¾åˆ—è¡¨ä¸­æŸä¸ªå…ƒç´ çš„ç´¢å¼•ã€‚è¿™éœ€è¦ä¸¤ä»¶äº‹ï¼šé¦–å…ˆéåŽ†åˆ—è¡¨ï¼Œå…¶æ¬¡è·Ÿè¸ªç´¢å¼•ã€‚ä¸è¿‡æœ‰ä¸€ä¸ªå°é—®é¢˜â€”â€”Haskell ä½¿ç”¨ä¸å¯å˜æ•°æ®ã€‚è®¾ç½®å€¼åŽä¸èƒ½æ›´æ”¹å®ƒã€‚åœ¨ GHCi ä¸­çœ‹èµ·æ¥ä¼¼ä¹Žå¯ä»¥ï¼Œä½†å®žé™…ä¸Šä¸è¡Œã€‚å½“ä½ â€œæ›´æ”¹â€ä¸€ä¸ªå€¼æ—¶ï¼Œå®žé™…ä¸Šæ˜¯åœ¨è¦†ç›–å®ƒã€‚åœ¨å‡½æ•°ä¸­æ— æ³•è¿™æ ·æ“ä½œã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æ²¡æœ‰å¾ªçŽ¯çš„æ¦‚å¿µã€‚é‚£ä¹ˆå¦‚ä½•éåŽ†åˆ—è¡¨å‘¢ï¼Ÿåœ¨çº¯å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œç­”æ¡ˆæ˜¯é€’å½’ã€‚

å‡½æ•°å¯ä»¥åŸºäºŽè‡ªèº«å®šä¹‰ï¼Œè¿™å°±æ˜¯é€’å½’çš„æ¦‚å¿µã€‚å› ä¸ºæ— æ³•ä½¿ç”¨å¾ªçŽ¯ï¼Œæˆ‘ä»¬å¿…é¡»èƒ½å¤Ÿå¯¹æ•°æ®çš„ä¸åŒéƒ¨åˆ†åå¤åº”ç”¨ç›¸åŒçš„å®šä¹‰ã€‚

è®©æˆ‘ä»¬æ¥çœ‹å¦‚ä½•é€’å½’å®žçŽ°ä¸€ä¸ªè®¡ç®—åˆ—è¡¨é•¿åº¦çš„å‡½æ•°ã€‚å‡è®¾å¯ä»¥å°†åˆ—è¡¨åˆ†æˆç¬¬ä¸€ä¸ªå…ƒç´ å’Œå‰©ä½™éƒ¨åˆ†ï¼Œé‚£ä¹ˆåˆ—è¡¨é•¿åº¦å¯ä»¥å®šä¹‰ä¸ºå‰©ä½™éƒ¨åˆ†çš„é•¿åº¦åŠ ä¸€ã€‚å‰©ä½™éƒ¨åˆ†çš„é•¿åº¦åˆ™é€’å½’è®¡ç®—ã€‚ä½†å¦‚ä½•æ‹†åˆ†æ•°æ®ç»“æž„å‘¢ï¼Ÿ

è¿™å¯ä»¥é€šè¿‡**æ¨¡å¼åŒ¹é…**å®žçŽ°ã€‚æ¨¡å¼åŒ¹é…æ˜¯ä¸€ä¸ªå¼ºå¤§çš„è¯­è¨€ç‰¹æ€§ï¼Œå¯ä»¥é’ˆå¯¹ä¸åŒâ€œæ¨¡å¼â€çš„æ•°æ®ç¼–å†™å‡½æ•°å®šä¹‰ã€‚å…ˆçœ‹å¦‚ä½•å®žçŽ°è®¡ç®—åˆ—è¡¨é•¿åº¦çš„å‡½æ•°ã€‚é•¿åº¦å·²çŸ¥çš„åˆ—è¡¨æ˜¯ç©ºåˆ—è¡¨ï¼š

```haskell
listLength [] = 0
```

è¿™é‡Œè¡¨ç¤ºå¦‚æžœè¾“å…¥æ˜¯ç©ºåˆ—è¡¨ï¼Œç»“æžœå°±æ˜¯ 0ã€‚è¿™ä¸ªå‡½æ•°æ˜¯**éƒ¨åˆ†å‡½æ•°**ï¼Œæ„å‘³ç€å­˜åœ¨æœªå®šä¹‰çš„è¾“å…¥ã€‚æµ‹è¯•å¦‚ä¸‹ï¼š

```haskell
ghci> listLength []
0
ghci> listLength [1,2,3]
*** Exception: .../src/Lib.hs:...: Non-exhaustive patterns in function listLength
```

Haskell å‘Šè¯‰æˆ‘ä»¬å­˜åœ¨æœªåŒ¹é…çš„è¾“å…¥ï¼Œå³æ¨¡å¼ä¸å®Œæ•´ã€‚å¦‚ä½•è®©å®ƒå®Œæ•´å‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦ç†è§£åˆ—è¡¨æœ‰ä¸¤ä¸ªæž„é€ å­ï¼ˆconstructorsï¼‰ï¼š`[]` å’Œ `(:)`ã€‚

- `[]`ï¼šç©ºåˆ—è¡¨
- `(:)`ï¼šå‰ç½®æ“ä½œï¼Œå°†ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°çŽ°æœ‰åˆ—è¡¨å‰é¢

ç¤ºä¾‹ï¼š

```haskell
ghci> []
[]
ghci> 1 : []
[1]
ghci> 1 : [2,3]
[1,2,3]
ghci> 1 : 2 : 3 : []
[1,2,3]
```

è¿™äº›æž„é€ å­ç”¨äºŽæ¨¡å¼åŒ¹é…ã€‚æˆ‘ä»¬å·²ç»åœ¨å®šä¹‰ä¸­ä½¿ç”¨äº† `[]`ã€‚ä¸ºäº†å®Œæ•´åŒ¹é…ï¼Œè¿˜éœ€æ·»åŠ  `(:)` æž„é€ å­ï¼Œè¿™å°±æ˜¯å¸¸è§çš„åˆ—è¡¨æ¨¡å¼åŒ¹é…ï¼š

**åˆ—è¡¨ 2.7 åˆ—è¡¨æ¨¡å¼åŒ¹é…ç¤ºä¾‹**

```haskell
listLength [] = 0         #1
listLength (x:xs) = ...   #2
```

- \#1 åŒ¹é…ç©ºåˆ—è¡¨
- \#2 åŒ¹é…é€šè¿‡å‰ç½®æ“ä½œæž„å»ºçš„åˆ—è¡¨

è¿™å¯èƒ½çœ‹èµ·æ¥æœ‰äº›å¥‡æ€ªï¼Œä½†åœ¨ Haskell ä¸­ï¼Œä½ å¯ä»¥ä¸ºä¸åŒçš„æ¨¡å¼åˆ›å»º**éƒ¨åˆ†å‡½æ•°å®šä¹‰**ï¼Œæœ¬è´¨ä¸Šå¯ä»¥ä¸ºæ¯ç§æ¨¡å¼å®šä¹‰å®Œå…¨ä¸åŒçš„è¡Œä¸ºã€‚

> **æ³¨**ï¼šå¯¹äºŽåˆ—è¡¨ï¼Œæˆ‘ä»¬ä»‹ç»çš„è¿™ä¸¤ç§æ¨¡å¼æ€»æ˜¯**å®Œæ•´è¦†ç›–**çš„ï¼

åœ¨ `(x:xs)` æ¨¡å¼ä¸­ï¼Œ`x` è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆheadï¼‰ï¼Œ`xs` è¡¨ç¤ºå‰©ä½™éƒ¨åˆ†ï¼ˆtailï¼‰ã€‚å¦‚å›¾ 2.6 æ‰€ç¤ºï¼Œå¦‚æžœåˆ—è¡¨åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œåˆ™ `xs = []`ã€‚åˆ—è¡¨é•¿åº¦è®¡ç®—æ–¹æ³•ï¼šç©ºåˆ—è¡¨é•¿åº¦ä¸º 0ï¼›éžç©ºåˆ—è¡¨é•¿åº¦ä¸º `1 + listLength xs`ï¼Œå³ç¬¬ä¸€ä¸ªå…ƒç´ åŠ ä¸Šå‰©ä½™éƒ¨åˆ†çš„é•¿åº¦é€’å½’è®¡ç®—ï¼š

è¿™é‡Œæˆ‘ä»¬å¾—åˆ°äº†ç¬¬ä¸€ä¸ªé€’å½’å‡½æ•°ï¼å¦‚æžœåˆ—è¡¨æœ‰é™ï¼Œè¯¥å‡½æ•°ä¼šç»ˆæ­¢ï¼Œå› ä¸ºæœ€ç»ˆä¼šé‡åˆ° `[]`ã€‚

> ![figure2-6](/img/learn-haskell-by-example/chapter2/figure2-6.png)
>
> å›¾ 2.6 éžç©ºåˆ—è¡¨çš„æ¨¡å¼åŒ¹é…

é‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•è®¡ç®—åˆ—è¡¨çš„é•¿åº¦å‘¢ï¼Ÿæ˜¾ç„¶ï¼Œç©ºåˆ—è¡¨çš„é•¿åº¦æ˜¯ **0**ï¼Œä½†å¦‚æžœåˆ—è¡¨ç”±ä¸€ä¸ªå…ƒç´  `x` å’Œå…¶ä½™éƒ¨åˆ† `xs` ç»„æˆå‘¢ï¼Ÿæ­£å¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„é‚£æ ·ï¼Œå®ƒçš„é•¿åº¦åº”å½“æ˜¯ **`xs` çš„é•¿åº¦åŠ  1**ï¼Œå› ä¸º `x` æ˜¯åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»è¢«è®¡æ•°ï¼‰ï¼Œè€Œå…¶ä½™éƒ¨åˆ†çš„é•¿åº¦æ˜¯é€šè¿‡é€’å½’åœ°è®¡ç®— `xs` çš„é•¿åº¦å¾—åˆ°çš„ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰è¿™ä¸ªå‡½æ•°ï¼š

```haskell
listLength [] = 0
listLength (x : xs) = 1 + listLength xs
```

è¿™é‡Œæˆ‘ä»¬å¾—åˆ°äº†ç¬¬ä¸€ä¸ªé€’å½’å‡½æ•°ï¼åªè¦ä¼ å…¥çš„åˆ—è¡¨æ˜¯æœ‰é™çš„ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šç»ˆæ­¢ï¼Œå› ä¸ºå®šä¹‰æœ€ç»ˆä¼šåœ¨é‡åˆ°ç©ºåˆ—è¡¨ `[]` æ—¶ç»“æŸã€‚

ä¸Žè®¡ç®—åˆ—è¡¨é•¿åº¦çš„å‡½æ•°ç±»ä¼¼ï¼Œ**èŽ·å–æŸä¸ªå…ƒç´ åœ¨åˆ—è¡¨ä¸­çš„ç´¢å¼•** ä¹Ÿå¯ä»¥é€šè¿‡é€’å½’å®žçŽ°ã€‚å½“åˆ—è¡¨è‡³å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œè¿™ä¸ªé—®é¢˜å…¶å®žå¾ˆç®€å•ï¼š
å¦‚æžœç¬¬ä¸€ä¸ªå…ƒç´ å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„é‚£ä¸ªï¼Œé‚£ä¹ˆç´¢å¼•å°±æ˜¯ **0**ï¼ˆå› ä¸ºç´¢å¼•ä»Ž 0 å¼€å§‹ï¼‰ï¼›ä½†å¦‚æžœä¸æ˜¯ï¼Œæˆ‘ä»¬å°±è¦åœ¨å½“å‰åˆ—è¡¨çš„å°¾éƒ¨ç»§ç»­æŸ¥æ‰¾ã€‚
æˆ‘ä»¬å¯ä»¥è¿™æ ·å¼€å§‹å®šä¹‰ï¼š

```haskell
indexOf :: Char -> [Char] -> Int
indexOf ch (x : xs) = if x == ch then 0 else 1 + indexOf ch xs
```

è¿™ä¸ªå‡½æ•°ä»Žåˆ—è¡¨å¼€å¤´å¼€å§‹æ£€æŸ¥ã€‚å¦‚æžœç¬¬ä¸€ä¸ªå…ƒç´ å°±æ˜¯ç›®æ ‡å…ƒç´ ï¼Œé‚£ä¹ˆç´¢å¼•æ˜¯ **0**ï¼›å¦åˆ™ï¼Œæˆ‘ä»¬åœ¨åˆ—è¡¨çš„å°¾éƒ¨é€’å½’æœç´¢ã€‚é€’å½’è°ƒç”¨çš„ç»“æžœä¼š**æ­£å¥½åç§» 1**ï¼ˆå› ä¸ºæˆ‘ä»¬åœ¨é€’å½’æ—¶å¿½ç•¥äº†ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œå› æ­¤è¦å°†ç»“æžœåŠ  1ã€‚å½“ç„¶ï¼Œè¿™é‡Œå‡è®¾é€’å½’è°ƒç”¨çš„ç»“æžœæ˜¯æ­£ç¡®çš„ã€‚çŽ°åœ¨å…³é”®çš„é—®é¢˜æ˜¯ï¼š**å½“åˆ—è¡¨ä¸ºç©ºæ—¶æ€Žä¹ˆåŠžï¼Ÿ**æ­¤æ—¶æ²¡æœ‰æ­£ç¡®çš„ç»“æžœï¼å› æ­¤ï¼Œæˆ‘ä»¬ä¼šæ˜¾å¼åœ°å°†è¿™ç§æƒ…å†µå®šä¹‰ä¸º **`undefined`**ã€‚å®Œæ•´çš„å®žçŽ°å¦‚ä¸‹æ‰€ç¤ºã€‚

**æ¸…å• 2.8 åœ¨å­—ç¬¦åˆ—è¡¨ä¸­è®¡ç®—å­—ç¬¦ç´¢å¼•çš„å‡½æ•°**

```haskell
indexOf :: Char -> [Char] -> Int
indexOf ch [] = undefined              #1
indexOf ch (x:xs) = if x == ch then 0 else 1 + indexOf ch xs   #2
```

- \#1 å½“åˆ—è¡¨ä¸ºç©ºæˆ–é€’å½’ç»“æŸæ—¶æŠ›å‡ºå¼‚å¸¸
- \#2 é€’å½’è®¡ç®—å­—ç¬¦åœ¨åˆ—è¡¨ä¸­çš„ç´¢å¼•

ä½¿ç”¨æ—¶å¿…é¡»ç¡®ä¿å­—ç¬¦å­˜åœ¨äºŽåˆ—è¡¨ï¼Œå¦åˆ™ç¨‹åºä¼šå´©æºƒï¼š

```haskell
ghci> indexOf 'a' lowerAlphabet
0
ghci> indexOf 'f' lowerAlphabet
5
ghci> indexOf 'f' upperAlphabet
*** Exception: Prelude.undefined
```

> æ³¨æ„ï¼šæ˜¾å¼ä½¿ç”¨ `undefined` é£Žæ ¼å¾ˆå·®ã€‚æˆ‘ä»¬å°†åœ¨ç¬¬ 3 ç« å­¦ä¹ æ›´å¥½çš„å¤„ç†æ–¹æ³•ã€‚æ­£ç¡®èŽ·å–å…ƒç´ ç´¢å¼•çš„å‡½æ•°æ˜¯ `Data.List` æ¨¡å—çš„ `elemIndex`ã€‚

å› ä¸ºæˆ‘ä»¬æŽ§åˆ¶å‡½æ•°çš„ä½¿ç”¨ï¼Œç›®å‰è¿™æ ·å¯ä»¥ã€‚ä½†ä¸ºäº†æ›´æ˜Žç¡®åœ°è¡¨ç¤ºå‡½æ•°åº”åœ¨å­—æ¯è¡¨ä¸Šä½¿ç”¨ï¼Œè€Œä¸æ˜¯ä»»æ„å­—ç¬¦åˆ—è¡¨ï¼Œå¯ä»¥ä¿®æ”¹ç±»åž‹ï¼š

```haskell
indexOf :: Char -> Alphabet -> Int
```
