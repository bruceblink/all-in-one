---
sidebar_position: 3
typora-root-url: ./..\..\static
---
# 第 2 章 古老的秘密在现代机器上延续（Ancient secret keeping on modern machines）


本章内容包括：

- 如何建立一个基础的 Haskell 项目并运行代码
- Haskell 常见数据类型与函数的工作原理
- 使用字符串和列表执行基本操作
- 通过守卫（guards）与模式匹配（pattern matching）处理不同情况
- 操作不可变数据并表示数据转换

在上一章中，我们了解了 Haskell 是什么，并讨论了它在语言设计上的一些独特之处。我们还学习了纯函数（pure functions）的特性，以及像 Haskell 这样的纯函数式语言是如何组织程序结构的。
 这些概念固然重要，但光说不练是没有意义的——理论必须结合实践才能真正掌握。现在，是时候动手实现我们的第一个项目了！

学习任何一门编程语言，总得从某处开始。虽然我可以用数学推导或学术练习来“折磨”你，但这本书的主题更轻松一点。有人甚至会说这些内容挺有趣——不过你不一定得这么认为。本章主要介绍 Haskell 的语法以及编写程序的基本方式。由于 Haskell 的核心理念与其他主流语言大相径庭，你最好暂时“忘掉”自己熟悉的一些编程模式。可变变量？静态数据？命令式控制流？——这些概念在我们即将踏入的世界中都是不存在的“黑魔法”。

我知道刚才的比喻有点夸张，所以让我解释一下：Haskell 的纯函数式设计一开始可能会让人望而生畏。如果你之前没有接触过函数式语言，那么本章的概念可能会显得有些奇怪。这主要是因为这种语言的设计思路与我们熟悉的命令式语言截然不同。举个例子，**Haskell 没有循环！** 当然，Haskell 有很多方式可以实现与循环类似的功能。严格来说，我们根本不需要循环——但这也意味着我们必须重新思考许多关于“编程”的旧习惯。

虽然这听起来有些可怕，但这趟旅程非常值得。Haskell 的核心概念是普适的——几乎可以在任何其他语言中实现。学习纯函数式编程的过程，其实是在学习一种全新的思维方式：如何用数学化的思考方式写出正确且可靠的程序。

本章将从建立一个新的 Haskell 项目开始，并使用 Haskell 编译器的交互模式（REPL）来编写与测试原型代码。接着，我们会介绍 Haskell 的多种基本数据类型，以及如何为函数和表达式定义类型。然后我们将学习如何编写函数、操作字符串与列表；进一步，通过守卫和模式匹配深入理解函数的结构与控制逻辑。最后，本章会介绍并使用内置的 **`map`** 函数。


## 2.1 Haskell 入门

现代计算机系统几乎都依赖外部网络才能高效工作。无论是通过 NTP 或 PTP 进行时间同步、在分布式 NoSQL 数据库中存储数据，还是晚上看一段 4K 猫咪视频——网络无处不在。但这也带来了一个重大问题：**我们必须保护在公共网络中传输的个人数据。**我们不能把自己的银行账户信息对着森林大喊一遍，然后祈祷没人听见。

正如你可能已经猜到的，解决方案就是——**加密（encryption）** 。加密的基本思路是使用一个双方共享的“密钥”来对信息进行编码。如今，密码学（cryptography）已深深融入我们的日常生活，而它的研究领域也在不断发展，提出越来越复杂的算法与协议来实现“安全保密”的目标。

在本章中，我们将实现一种最古老、最简单的加密方法——**凯撒密码（Caesar’s cipher）**。它在现实世界中早已不再安全，但它能很好地帮助我们理解函数式编程的基本原理。

------

### 2.1.1 凯撒密码（Caesar’s cipher）

这个古老的算法是如何工作的呢？凯撒密码通过将字母表中的每个字母按固定偏移量替换成另一个字母来实现加密。也就是说，你可以根据字母在字母表中的位置选择一个新的字母，从而加密原始字母。

你可以把字母表想象成一个轮盘，所有字母按顺序排列成一个圆圈。从某个字母开始，将轮盘旋转一定偏移量，就会得到新的字母。这个概念在图 2.1 中有示意。

> **图 2.1 字母替换轮盘**
>
> ![figure2-1](/img/learn-haskell-by-example/chapter2/figure2-1.png)

通过对信息中的每个字母进行变换，我们就可以对整条信息加密！用于这种变换的偏移量就是算法的**加密密钥**，需要通信双方都知道。在解密时，只需反向执行同样的操作，就可以恢复原始信息。图 2.2 展示了一个例子：一个小信息被加密时使用了偏移量 5。

>**图 2.2 凯撒密码加密示例**
>
>![figure2-2](/img/learn-haskell-by-example/chapter2/figure2-2.png)

如果只加密基本拉丁字母（并且大写字母和小写字母各自使用自己的字母表），会出现一种有趣的对称性：当偏移量为 13 时，加密和解密互相抵消，也就是说可以用完全相同的方法进行加密和解密。这种特殊的凯撒密码称为 **ROT13**，通常用作文字混淆工具，因为实现非常简单。一些编辑器，如 Vim 和 Emacs，甚至内置了 ROT13 功能！

示例：`Vfa’g gung arng?`

⚠️ **警告**
 为了保护你和他人的数据安全，切勿在任何应用程序中使用这种加密方法！

